/*
 *
 *                 #####    #####   ######  ######  ###   ###
 *               ##   ##  ##   ##  ##      ##      ## ### ##
 *              ##   ##  ##   ##  ####    ####    ##  #  ##
 *             ##   ##  ##   ##  ##      ##      ##     ##
 *            ##   ##  ##   ##  ##      ##      ##     ##
 *            #####    #####   ##      ######  ##     ##
 *
 *
 *             OOFEM : Object Oriented Finite Element Code
 *
 *               Copyright (C) 1993 - 2013   Borek Patzak
 *
 *
 *
 *       Czech Technical University, Faculty of Civil Engineering,
 *   Department of Structural Mechanics, 166 29 Prague, Czech Republic
 *
 *  This library is free software; you can redistribute it and/or
 *  modify it under the terms of the GNU Lesser General Public
 *  License as published by the Free Software Foundation; either
 *  version 2.1 of the License, or (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 *  Lesser General Public License for more details.
 *
 *  You should have received a copy of the GNU Lesser General Public
 *  License along with this library; if not, write to the Free Software
 *  Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 */

#include "floatmatrix.h"
#include "floatarray.h"
#include "mathfem.h"
#include "index.h"
#include "tensor2.h"
#include "FTensor/Tensor5/Tensor5_value.hpp"
#pragma once

using namespace FTensor;



/**
 * Functions providing basic operations with tensors
 * based on FTensor library
 * It provides transformation from the second and fourth order tensors in 3d to FloatArrayF<9> and FloatArray<9,9>
 * It provides calculation of determinant, cofactor, inverse, and tensor cross product
 * More to be added gradually
 * @author Ondrej Faltus
 **/

namespace oofem {
class Tensor5_3d : public Tensor5<double, 3, 3, 3, 3, 3>
{
public:
    using Tensor5<double, 3, 3, 3, 3, 3>::Tensor5;

    /**
     * Creates fifth-order tensor in 3d
     * Initialized with zeros
     */

    Tensor5_3d()
    {
        this->operator()( 0, 0, 0, 0, 0 ) = 0.;
        this->operator()( 0, 0, 0, 0, 1 ) = 0.;
        this->operator()( 0, 0, 0, 0, 2 ) = 0.;
        this->operator()( 0, 0, 0, 1, 0 ) = 0.;
        this->operator()( 0, 0, 0, 1, 1 ) = 0.;
        this->operator()( 0, 0, 0, 1, 2 ) = 0.;
        this->operator()( 0, 0, 0, 2, 0 ) = 0.;
        this->operator()( 0, 0, 0, 2, 1 ) = 0.;
        this->operator()( 0, 0, 0, 2, 2 ) = 0.;
        this->operator()( 0, 0, 1, 0, 0 ) = 0.;
        this->operator()( 0, 0, 1, 0, 1 ) = 0.;
        this->operator()( 0, 0, 1, 0, 2 ) = 0.;
        this->operator()( 0, 0, 1, 1, 0 ) = 0.;
        this->operator()( 0, 0, 1, 1, 1 ) = 0.;
        this->operator()( 0, 0, 1, 1, 2 ) = 0.;
        this->operator()( 0, 0, 1, 2, 0 ) = 0.;
        this->operator()( 0, 0, 1, 2, 1 ) = 0.;
        this->operator()( 0, 0, 1, 2, 2 ) = 0.;
        this->operator()( 0, 0, 2, 0, 0 ) = 0.;
        this->operator()( 0, 0, 2, 0, 1 ) = 0.;
        this->operator()( 0, 0, 2, 0, 2 ) = 0.;
        this->operator()( 0, 0, 2, 1, 0 ) = 0.;
        this->operator()( 0, 0, 2, 1, 1 ) = 0.;
        this->operator()( 0, 0, 2, 1, 2 ) = 0.;
        this->operator()( 0, 0, 2, 2, 0 ) = 0.;
        this->operator()( 0, 0, 2, 2, 1 ) = 0.;
        this->operator()( 0, 0, 2, 2, 2 ) = 0.;

        this->operator()( 0, 1, 0, 0, 0 ) = 0.;
        this->operator()( 0, 1, 0, 0, 1 ) = 0.;
        this->operator()( 0, 1, 0, 0, 2 ) = 0.;
        this->operator()( 0, 1, 0, 1, 0 ) = 0.;
        this->operator()( 0, 1, 0, 1, 1 ) = 0.;
        this->operator()( 0, 1, 0, 1, 2 ) = 0.;
        this->operator()( 0, 1, 0, 2, 0 ) = 0.;
        this->operator()( 0, 1, 0, 2, 1 ) = 0.;
        this->operator()( 0, 1, 0, 2, 2 ) = 0.;
        this->operator()( 0, 1, 1, 0, 0 ) = 0.;
        this->operator()( 0, 1, 1, 0, 1 ) = 0.;
        this->operator()( 0, 1, 1, 0, 2 ) = 0.;
        this->operator()( 0, 1, 1, 1, 0 ) = 0.;
        this->operator()( 0, 1, 1, 1, 1 ) = 0.;
        this->operator()( 0, 1, 1, 1, 2 ) = 0.;
        this->operator()( 0, 1, 1, 2, 0 ) = 0.;
        this->operator()( 0, 1, 1, 2, 1 ) = 0.;
        this->operator()( 0, 1, 1, 2, 2 ) = 0.;
        this->operator()( 0, 1, 2, 0, 0 ) = 0.;
        this->operator()( 0, 1, 2, 0, 1 ) = 0.;
        this->operator()( 0, 1, 2, 0, 2 ) = 0.;
        this->operator()( 0, 1, 2, 1, 0 ) = 0.;
        this->operator()( 0, 1, 2, 1, 1 ) = 0.;
        this->operator()( 0, 1, 2, 1, 2 ) = 0.;
        this->operator()( 0, 1, 2, 2, 0 ) = 0.;
        this->operator()( 0, 1, 2, 2, 1 ) = 0.;
        this->operator()( 0, 1, 2, 2, 2 ) = 0.;

        this->operator()( 0, 2, 0, 0, 0 ) = 0.;
        this->operator()( 0, 2, 0, 0, 1 ) = 0.;
        this->operator()( 0, 2, 0, 0, 2 ) = 0.;
        this->operator()( 0, 2, 0, 1, 0 ) = 0.;
        this->operator()( 0, 2, 0, 1, 1 ) = 0.;
        this->operator()( 0, 2, 0, 1, 2 ) = 0.;
        this->operator()( 0, 2, 0, 2, 0 ) = 0.;
        this->operator()( 0, 2, 0, 2, 1 ) = 0.;
        this->operator()( 0, 2, 0, 2, 2 ) = 0.;
        this->operator()( 0, 2, 1, 0, 0 ) = 0.;
        this->operator()( 0, 2, 1, 0, 1 ) = 0.;
        this->operator()( 0, 2, 1, 0, 2 ) = 0.;
        this->operator()( 0, 2, 1, 1, 0 ) = 0.;
        this->operator()( 0, 2, 1, 1, 1 ) = 0.;
        this->operator()( 0, 2, 1, 1, 2 ) = 0.;
        this->operator()( 0, 2, 1, 2, 0 ) = 0.;
        this->operator()( 0, 2, 1, 2, 1 ) = 0.;
        this->operator()( 0, 2, 1, 2, 2 ) = 0.;
        this->operator()( 0, 2, 2, 0, 0 ) = 0.;
        this->operator()( 0, 2, 2, 0, 1 ) = 0.;
        this->operator()( 0, 2, 2, 0, 2 ) = 0.;
        this->operator()( 0, 2, 2, 1, 0 ) = 0.;
        this->operator()( 0, 2, 2, 1, 1 ) = 0.;
        this->operator()( 0, 2, 2, 1, 2 ) = 0.;
        this->operator()( 0, 2, 2, 2, 0 ) = 0.;
        this->operator()( 0, 2, 2, 2, 1 ) = 0.;
        this->operator()( 0, 2, 2, 2, 2 ) = 0.;

        this->operator()( 1, 0, 0, 0, 0 ) = 0.;
        this->operator()( 1, 0, 0, 0, 1 ) = 0.;
        this->operator()( 1, 0, 0, 0, 2 ) = 0.;
        this->operator()( 1, 0, 0, 1, 0 ) = 0.;
        this->operator()( 1, 0, 0, 1, 1 ) = 0.;
        this->operator()( 1, 0, 0, 1, 2 ) = 0.;
        this->operator()( 1, 0, 0, 2, 0 ) = 0.;
        this->operator()( 1, 0, 0, 2, 1 ) = 0.;
        this->operator()( 1, 0, 0, 2, 2 ) = 0.;
        this->operator()( 1, 0, 1, 0, 0 ) = 0.;
        this->operator()( 1, 0, 1, 0, 1 ) = 0.;
        this->operator()( 1, 0, 1, 0, 2 ) = 0.;
        this->operator()( 1, 0, 1, 1, 0 ) = 0.;
        this->operator()( 1, 0, 1, 1, 1 ) = 0.;
        this->operator()( 1, 0, 1, 1, 2 ) = 0.;
        this->operator()( 1, 0, 1, 2, 0 ) = 0.;
        this->operator()( 1, 0, 1, 2, 1 ) = 0.;
        this->operator()( 1, 0, 1, 2, 2 ) = 0.;
        this->operator()( 1, 0, 2, 0, 0 ) = 0.;
        this->operator()( 1, 0, 2, 0, 1 ) = 0.;
        this->operator()( 1, 0, 2, 0, 2 ) = 0.;
        this->operator()( 1, 0, 2, 1, 0 ) = 0.;
        this->operator()( 1, 0, 2, 1, 1 ) = 0.;
        this->operator()( 1, 0, 2, 1, 2 ) = 0.;
        this->operator()( 1, 0, 2, 2, 0 ) = 0.;
        this->operator()( 1, 0, 2, 2, 1 ) = 0.;
        this->operator()( 1, 0, 2, 2, 2 ) = 0.;
                          
        this->operator()( 1, 1, 0, 0, 0 ) = 0.;
        this->operator()( 1, 1, 0, 0, 1 ) = 0.;
        this->operator()( 1, 1, 0, 0, 2 ) = 0.;
        this->operator()( 1, 1, 0, 1, 0 ) = 0.;
        this->operator()( 1, 1, 0, 1, 1 ) = 0.;
        this->operator()( 1, 1, 0, 1, 2 ) = 0.;
        this->operator()( 1, 1, 0, 2, 0 ) = 0.;
        this->operator()( 1, 1, 0, 2, 1 ) = 0.;
        this->operator()( 1, 1, 0, 2, 2 ) = 0.;
        this->operator()( 1, 1, 1, 0, 0 ) = 0.;
        this->operator()( 1, 1, 1, 0, 1 ) = 0.;
        this->operator()( 1, 1, 1, 0, 2 ) = 0.;
        this->operator()( 1, 1, 1, 1, 0 ) = 0.;
        this->operator()( 1, 1, 1, 1, 1 ) = 0.;
        this->operator()( 1, 1, 1, 1, 2 ) = 0.;
        this->operator()( 1, 1, 1, 2, 0 ) = 0.;
        this->operator()( 1, 1, 1, 2, 1 ) = 0.;
        this->operator()( 1, 1, 1, 2, 2 ) = 0.;
        this->operator()( 1, 1, 2, 0, 0 ) = 0.;
        this->operator()( 1, 1, 2, 0, 1 ) = 0.;
        this->operator()( 1, 1, 2, 0, 2 ) = 0.;
        this->operator()( 1, 1, 2, 1, 0 ) = 0.;
        this->operator()( 1, 1, 2, 1, 1 ) = 0.;
        this->operator()( 1, 1, 2, 1, 2 ) = 0.;
        this->operator()( 1, 1, 2, 2, 0 ) = 0.;
        this->operator()( 1, 1, 2, 2, 1 ) = 0.;
        this->operator()( 1, 1, 2, 2, 2 ) = 0.;
                          
        this->operator()( 1, 2, 0, 0, 0 ) = 0.;
        this->operator()( 1, 2, 0, 0, 1 ) = 0.;
        this->operator()( 1, 2, 0, 0, 2 ) = 0.;
        this->operator()( 1, 2, 0, 1, 0 ) = 0.;
        this->operator()( 1, 2, 0, 1, 1 ) = 0.;
        this->operator()( 1, 2, 0, 1, 2 ) = 0.;
        this->operator()( 1, 2, 0, 2, 0 ) = 0.;
        this->operator()( 1, 2, 0, 2, 1 ) = 0.;
        this->operator()( 1, 2, 0, 2, 2 ) = 0.;
        this->operator()( 1, 2, 1, 0, 0 ) = 0.;
        this->operator()( 1, 2, 1, 0, 1 ) = 0.;
        this->operator()( 1, 2, 1, 0, 2 ) = 0.;
        this->operator()( 1, 2, 1, 1, 0 ) = 0.;
        this->operator()( 1, 2, 1, 1, 1 ) = 0.;
        this->operator()( 1, 2, 1, 1, 2 ) = 0.;
        this->operator()( 1, 2, 1, 2, 0 ) = 0.;
        this->operator()( 1, 2, 1, 2, 1 ) = 0.;
        this->operator()( 1, 2, 1, 2, 2 ) = 0.;
        this->operator()( 1, 2, 2, 0, 0 ) = 0.;
        this->operator()( 1, 2, 2, 0, 1 ) = 0.;
        this->operator()( 1, 2, 2, 0, 2 ) = 0.;
        this->operator()( 1, 2, 2, 1, 0 ) = 0.;
        this->operator()( 1, 2, 2, 1, 1 ) = 0.;
        this->operator()( 1, 2, 2, 1, 2 ) = 0.;
        this->operator()( 1, 2, 2, 2, 0 ) = 0.;
        this->operator()( 1, 2, 2, 2, 1 ) = 0.;
        this->operator()( 1, 2, 2, 2, 2 ) = 0.;

        this->operator()( 2, 0, 0, 0, 0 ) = 0.;
        this->operator()( 2, 0, 0, 0, 1 ) = 0.;
        this->operator()( 2, 0, 0, 0, 2 ) = 0.;
        this->operator()( 2, 0, 0, 1, 0 ) = 0.;
        this->operator()( 2, 0, 0, 1, 1 ) = 0.;
        this->operator()( 2, 0, 0, 1, 2 ) = 0.;
        this->operator()( 2, 0, 0, 2, 0 ) = 0.;
        this->operator()( 2, 0, 0, 2, 1 ) = 0.;
        this->operator()( 2, 0, 0, 2, 2 ) = 0.;
        this->operator()( 2, 0, 1, 0, 0 ) = 0.;
        this->operator()( 2, 0, 1, 0, 1 ) = 0.;
        this->operator()( 2, 0, 1, 0, 2 ) = 0.;
        this->operator()( 2, 0, 1, 1, 0 ) = 0.;
        this->operator()( 2, 0, 1, 1, 1 ) = 0.;
        this->operator()( 2, 0, 1, 1, 2 ) = 0.;
        this->operator()( 2, 0, 1, 2, 0 ) = 0.;
        this->operator()( 2, 0, 1, 2, 1 ) = 0.;
        this->operator()( 2, 0, 1, 2, 2 ) = 0.;
        this->operator()( 2, 0, 2, 0, 0 ) = 0.;
        this->operator()( 2, 0, 2, 0, 1 ) = 0.;
        this->operator()( 2, 0, 2, 0, 2 ) = 0.;
        this->operator()( 2, 0, 2, 1, 0 ) = 0.;
        this->operator()( 2, 0, 2, 1, 1 ) = 0.;
        this->operator()( 2, 0, 2, 1, 2 ) = 0.;
        this->operator()( 2, 0, 2, 2, 0 ) = 0.;
        this->operator()( 2, 0, 2, 2, 1 ) = 0.;
        this->operator()( 2, 0, 2, 2, 2 ) = 0.;
                          
        this->operator()( 2, 1, 0, 0, 0 ) = 0.;
        this->operator()( 2, 1, 0, 0, 1 ) = 0.;
        this->operator()( 2, 1, 0, 0, 2 ) = 0.;
        this->operator()( 2, 1, 0, 1, 0 ) = 0.;
        this->operator()( 2, 1, 0, 1, 1 ) = 0.;
        this->operator()( 2, 1, 0, 1, 2 ) = 0.;
        this->operator()( 2, 1, 0, 2, 0 ) = 0.;
        this->operator()( 2, 1, 0, 2, 1 ) = 0.;
        this->operator()( 2, 1, 0, 2, 2 ) = 0.;
        this->operator()( 2, 1, 1, 0, 0 ) = 0.;
        this->operator()( 2, 1, 1, 0, 1 ) = 0.;
        this->operator()( 2, 1, 1, 0, 2 ) = 0.;
        this->operator()( 2, 1, 1, 1, 0 ) = 0.;
        this->operator()( 2, 1, 1, 1, 1 ) = 0.;
        this->operator()( 2, 1, 1, 1, 2 ) = 0.;
        this->operator()( 2, 1, 1, 2, 0 ) = 0.;
        this->operator()( 2, 1, 1, 2, 1 ) = 0.;
        this->operator()( 2, 1, 1, 2, 2 ) = 0.;
        this->operator()( 2, 1, 2, 0, 0 ) = 0.;
        this->operator()( 2, 1, 2, 0, 1 ) = 0.;
        this->operator()( 2, 1, 2, 0, 2 ) = 0.;
        this->operator()( 2, 1, 2, 1, 0 ) = 0.;
        this->operator()( 2, 1, 2, 1, 1 ) = 0.;
        this->operator()( 2, 1, 2, 1, 2 ) = 0.;
        this->operator()( 2, 1, 2, 2, 0 ) = 0.;
        this->operator()( 2, 1, 2, 2, 1 ) = 0.;
        this->operator()( 2, 1, 2, 2, 2 ) = 0.;
                          
        this->operator()( 2, 2, 0, 0, 0 ) = 0.;
        this->operator()( 2, 2, 0, 0, 1 ) = 0.;
        this->operator()( 2, 2, 0, 0, 2 ) = 0.;
        this->operator()( 2, 2, 0, 1, 0 ) = 0.;
        this->operator()( 2, 2, 0, 1, 1 ) = 0.;
        this->operator()( 2, 2, 0, 1, 2 ) = 0.;
        this->operator()( 2, 2, 0, 2, 0 ) = 0.;
        this->operator()( 2, 2, 0, 2, 1 ) = 0.;
        this->operator()( 2, 2, 0, 2, 2 ) = 0.;
        this->operator()( 2, 2, 1, 0, 0 ) = 0.;
        this->operator()( 2, 2, 1, 0, 1 ) = 0.;
        this->operator()( 2, 2, 1, 0, 2 ) = 0.;
        this->operator()( 2, 2, 1, 1, 0 ) = 0.;
        this->operator()( 2, 2, 1, 1, 1 ) = 0.;
        this->operator()( 2, 2, 1, 1, 2 ) = 0.;
        this->operator()( 2, 2, 1, 2, 0 ) = 0.;
        this->operator()( 2, 2, 1, 2, 1 ) = 0.;
        this->operator()( 2, 2, 1, 2, 2 ) = 0.;
        this->operator()( 2, 2, 2, 0, 0 ) = 0.;
        this->operator()( 2, 2, 2, 0, 1 ) = 0.;
        this->operator()( 2, 2, 2, 0, 2 ) = 0.;
        this->operator()( 2, 2, 2, 1, 0 ) = 0.;
        this->operator()( 2, 2, 2, 1, 1 ) = 0.;
        this->operator()( 2, 2, 2, 1, 2 ) = 0.;
        this->operator()( 2, 2, 2, 2, 0 ) = 0.;
        this->operator()( 2, 2, 2, 2, 1 ) = 0.;
        this->operator()( 2, 2, 2, 2, 2 ) = 0.;
    }

    /**
     * Creates a fifth-order order tensor in 3d from floatmatrixf<9, 27>
     */

    Tensor5_3d( const FloatMatrixF<9, 27> &matrix )
    {

      this->operator()( 0, 0, 0, 0, 0 ) = matrix.at( 1, 1 );
      this->operator()( 0, 0, 1, 1, 0 ) = matrix.at( 1, 2 );
      this->operator()( 0, 0, 2, 2, 0 ) = matrix.at( 1, 3 );
      this->operator()( 0, 0, 1, 2, 0 ) = matrix.at( 1, 4 );
      this->operator()( 0, 0, 0, 2, 0 ) = matrix.at( 1, 5 );
      this->operator()( 0, 0, 0, 1, 0 ) = matrix.at( 1, 6 );
      this->operator()( 0, 0, 2, 1, 0 ) = matrix.at( 1, 7 );
      this->operator()( 0, 0, 2, 0, 0 ) = matrix.at( 1, 8 );
      this->operator()( 0, 0, 1, 0, 0 ) = matrix.at( 1, 9 );
      this->operator()( 0, 0, 0, 0, 1 ) = matrix.at( 1, 10 );
      this->operator()( 0, 0, 1, 1, 1 ) = matrix.at( 1, 11 );
      this->operator()( 0, 0, 2, 2, 1 ) = matrix.at( 1, 12 );
      this->operator()( 0, 0, 1, 2, 1 ) = matrix.at( 1, 13 );
      this->operator()( 0, 0, 0, 2, 1 ) = matrix.at( 1, 14 );
      this->operator()( 0, 0, 0, 1, 1 ) = matrix.at( 1, 15 );
      this->operator()( 0, 0, 2, 1, 1 ) = matrix.at( 1, 16 );
      this->operator()( 0, 0, 2, 0, 1 ) = matrix.at( 1, 17 );
      this->operator()( 0, 0, 1, 0, 1 ) = matrix.at( 1, 18 );
      this->operator()( 0, 0, 0, 0, 2 ) = matrix.at( 1, 19 );
      this->operator()( 0, 0, 1, 1, 2 ) = matrix.at( 1, 20 );
      this->operator()( 0, 0, 2, 2, 2 ) = matrix.at( 1, 21 );
      this->operator()( 0, 0, 1, 2, 2 ) = matrix.at( 1, 22 );
      this->operator()( 0, 0, 0, 2, 2 ) = matrix.at( 1, 23 );
      this->operator()( 0, 0, 0, 1, 2 ) = matrix.at( 1, 24 );
      this->operator()( 0, 0, 2, 1, 2 ) = matrix.at( 1, 25 );
      this->operator()( 0, 0, 2, 0, 2 ) = matrix.at( 1, 26 );
      this->operator()( 0, 0, 1, 0, 2 ) = matrix.at( 1, 27 );
      this->operator()( 1, 1, 0, 0, 0 ) = matrix.at( 2, 1 );
      this->operator()( 1, 1, 1, 1, 0 ) = matrix.at( 2, 2 );
      this->operator()( 1, 1, 2, 2, 0 ) = matrix.at( 2, 3 );
      this->operator()( 1, 1, 1, 2, 0 ) = matrix.at( 2, 4 );
      this->operator()( 1, 1, 0, 2, 0 ) = matrix.at( 2, 5 );
      this->operator()( 1, 1, 0, 1, 0 ) = matrix.at( 2, 6 );
      this->operator()( 1, 1, 2, 1, 0 ) = matrix.at( 2, 7 );
      this->operator()( 1, 1, 2, 0, 0 ) = matrix.at( 2, 8 );
      this->operator()( 1, 1, 1, 0, 0 ) = matrix.at( 2, 9 );
      this->operator()( 1, 1, 0, 0, 1 ) = matrix.at( 2, 10 );
      this->operator()( 1, 1, 1, 1, 1 ) = matrix.at( 2, 11 );
      this->operator()( 1, 1, 2, 2, 1 ) = matrix.at( 2, 12 );
      this->operator()( 1, 1, 1, 2, 1 ) = matrix.at( 2, 13 );
      this->operator()( 1, 1, 0, 2, 1 ) = matrix.at( 2, 14 );
      this->operator()( 1, 1, 0, 1, 1 ) = matrix.at( 2, 15 );
      this->operator()( 1, 1, 2, 1, 1 ) = matrix.at( 2, 16 );
      this->operator()( 1, 1, 2, 0, 1 ) = matrix.at( 2, 17 );
      this->operator()( 1, 1, 1, 0, 1 ) = matrix.at( 2, 18 );
      this->operator()( 1, 1, 0, 0, 2 ) = matrix.at( 2, 19 );
      this->operator()( 1, 1, 1, 1, 2 ) = matrix.at( 2, 20 );
      this->operator()( 1, 1, 2, 2, 2 ) = matrix.at( 2, 21 );
      this->operator()( 1, 1, 1, 2, 2 ) = matrix.at( 2, 22 );
      this->operator()( 1, 1, 0, 2, 2 ) = matrix.at( 2, 23 );
      this->operator()( 1, 1, 0, 1, 2 ) = matrix.at( 2, 24 );
      this->operator()( 1, 1, 2, 1, 2 ) = matrix.at( 2, 25 );
      this->operator()( 1, 1, 2, 0, 2 ) = matrix.at( 2, 26 );
      this->operator()( 1, 1, 1, 0, 2 ) = matrix.at( 2, 27 );
      this->operator()( 2, 2, 0, 0, 0 ) = matrix.at( 3, 1 );
      this->operator()( 2, 2, 1, 1, 0 ) = matrix.at( 3, 2 );
      this->operator()( 2, 2, 2, 2, 0 ) = matrix.at( 3, 3 );
      this->operator()( 2, 2, 1, 2, 0 ) = matrix.at( 3, 4 );
      this->operator()( 2, 2, 0, 2, 0 ) = matrix.at( 3, 5 );
      this->operator()( 2, 2, 0, 1, 0 ) = matrix.at( 3, 6 );
      this->operator()( 2, 2, 2, 1, 0 ) = matrix.at( 3, 7 );
      this->operator()( 2, 2, 2, 0, 0 ) = matrix.at( 3, 8 );
      this->operator()( 2, 2, 1, 0, 0 ) = matrix.at( 3, 9 );
      this->operator()( 2, 2, 0, 0, 1 ) = matrix.at( 3, 10 );
      this->operator()( 2, 2, 1, 1, 1 ) = matrix.at( 3, 11 );
      this->operator()( 2, 2, 2, 2, 1 ) = matrix.at( 3, 12 );
      this->operator()( 2, 2, 1, 2, 1 ) = matrix.at( 3, 13 );
      this->operator()( 2, 2, 0, 2, 1 ) = matrix.at( 3, 14 );
      this->operator()( 2, 2, 0, 1, 1 ) = matrix.at( 3, 15 );
      this->operator()( 2, 2, 2, 1, 1 ) = matrix.at( 3, 16 );
      this->operator()( 2, 2, 2, 0, 1 ) = matrix.at( 3, 17 );
      this->operator()( 2, 2, 1, 0, 1 ) = matrix.at( 3, 18 );
      this->operator()( 2, 2, 0, 0, 2 ) = matrix.at( 3, 19 );
      this->operator()( 2, 2, 1, 1, 2 ) = matrix.at( 3, 20 );
      this->operator()( 2, 2, 2, 2, 2 ) = matrix.at( 3, 21 );
      this->operator()( 2, 2, 1, 2, 2 ) = matrix.at( 3, 22 );
      this->operator()( 2, 2, 0, 2, 2 ) = matrix.at( 3, 23 );
      this->operator()( 2, 2, 0, 1, 2 ) = matrix.at( 3, 24 );
      this->operator()( 2, 2, 2, 1, 2 ) = matrix.at( 3, 25 );
      this->operator()( 2, 2, 2, 0, 2 ) = matrix.at( 3, 26 );
      this->operator()( 2, 2, 1, 0, 2 ) = matrix.at( 3, 27 );
      this->operator()( 1, 2, 0, 0, 0 ) = matrix.at( 4, 1 );
      this->operator()( 1, 2, 1, 1, 0 ) = matrix.at( 4, 2 );
      this->operator()( 1, 2, 2, 2, 0 ) = matrix.at( 4, 3 );
      this->operator()( 1, 2, 1, 2, 0 ) = matrix.at( 4, 4 );
      this->operator()( 1, 2, 0, 2, 0 ) = matrix.at( 4, 5 );
      this->operator()( 1, 2, 0, 1, 0 ) = matrix.at( 4, 6 );
      this->operator()( 1, 2, 2, 1, 0 ) = matrix.at( 4, 7 );
      this->operator()( 1, 2, 2, 0, 0 ) = matrix.at( 4, 8 );
      this->operator()( 1, 2, 1, 0, 0 ) = matrix.at( 4, 9 );
      this->operator()( 1, 2, 0, 0, 1 ) = matrix.at( 4, 10 );
      this->operator()( 1, 2, 1, 1, 1 ) = matrix.at( 4, 11 );
      this->operator()( 1, 2, 2, 2, 1 ) = matrix.at( 4, 12 );
      this->operator()( 1, 2, 1, 2, 1 ) = matrix.at( 4, 13 );
      this->operator()( 1, 2, 0, 2, 1 ) = matrix.at( 4, 14 );
      this->operator()( 1, 2, 0, 1, 1 ) = matrix.at( 4, 15 );
      this->operator()( 1, 2, 2, 1, 1 ) = matrix.at( 4, 16 );
      this->operator()( 1, 2, 2, 0, 1 ) = matrix.at( 4, 17 );
      this->operator()( 1, 2, 1, 0, 1 ) = matrix.at( 4, 18 );
      this->operator()( 1, 2, 0, 0, 2 ) = matrix.at( 4, 19 );
      this->operator()( 1, 2, 1, 1, 2 ) = matrix.at( 4, 20 );
      this->operator()( 1, 2, 2, 2, 2 ) = matrix.at( 4, 21 );
      this->operator()( 1, 2, 1, 2, 2 ) = matrix.at( 4, 22 );
      this->operator()( 1, 2, 0, 2, 2 ) = matrix.at( 4, 23 );
      this->operator()( 1, 2, 0, 1, 2 ) = matrix.at( 4, 24 );
      this->operator()( 1, 2, 2, 1, 2 ) = matrix.at( 4, 25 );
      this->operator()( 1, 2, 2, 0, 2 ) = matrix.at( 4, 26 );
      this->operator()( 1, 2, 1, 0, 2 ) = matrix.at( 4, 27 );
      this->operator()( 0, 2, 0, 0, 0 ) = matrix.at( 5, 1 );
      this->operator()( 0, 2, 1, 1, 0 ) = matrix.at( 5, 2 );
      this->operator()( 0, 2, 2, 2, 0 ) = matrix.at( 5, 3 );
      this->operator()( 0, 2, 1, 2, 0 ) = matrix.at( 5, 4 );
      this->operator()( 0, 2, 0, 2, 0 ) = matrix.at( 5, 5 );
      this->operator()( 0, 2, 0, 1, 0 ) = matrix.at( 5, 6 );
      this->operator()( 0, 2, 2, 1, 0 ) = matrix.at( 5, 7 );
      this->operator()( 0, 2, 2, 0, 0 ) = matrix.at( 5, 8 );
      this->operator()( 0, 2, 1, 0, 0 ) = matrix.at( 5, 9 );
      this->operator()( 0, 2, 0, 0, 1 ) = matrix.at( 5, 10 );
      this->operator()( 0, 2, 1, 1, 1 ) = matrix.at( 5, 11 );
      this->operator()( 0, 2, 2, 2, 1 ) = matrix.at( 5, 12 );
      this->operator()( 0, 2, 1, 2, 1 ) = matrix.at( 5, 13 );
      this->operator()( 0, 2, 0, 2, 1 ) = matrix.at( 5, 14 );
      this->operator()( 0, 2, 0, 1, 1 ) = matrix.at( 5, 15 );
      this->operator()( 0, 2, 2, 1, 1 ) = matrix.at( 5, 16 );
      this->operator()( 0, 2, 2, 0, 1 ) = matrix.at( 5, 17 );
      this->operator()( 0, 2, 1, 0, 1 ) = matrix.at( 5, 18 );
      this->operator()( 0, 2, 0, 0, 2 ) = matrix.at( 5, 19 );
      this->operator()( 0, 2, 1, 1, 2 ) = matrix.at( 5, 20 );
      this->operator()( 0, 2, 2, 2, 2 ) = matrix.at( 5, 21 );
      this->operator()( 0, 2, 1, 2, 2 ) = matrix.at( 5, 22 );
      this->operator()( 0, 2, 0, 2, 2 ) = matrix.at( 5, 23 );
      this->operator()( 0, 2, 0, 1, 2 ) = matrix.at( 5, 24 );
      this->operator()( 0, 2, 2, 1, 2 ) = matrix.at( 5, 25 );
      this->operator()( 0, 2, 2, 0, 2 ) = matrix.at( 5, 26 );
      this->operator()( 0, 2, 1, 0, 2 ) = matrix.at( 5, 27 );
      this->operator()( 0, 1, 0, 0, 0 ) = matrix.at( 6, 1 );
      this->operator()( 0, 1, 1, 1, 0 ) = matrix.at( 6, 2 );
      this->operator()( 0, 1, 2, 2, 0 ) = matrix.at( 6, 3 );
      this->operator()( 0, 1, 1, 2, 0 ) = matrix.at( 6, 4 );
      this->operator()( 0, 1, 0, 2, 0 ) = matrix.at( 6, 5 );
      this->operator()( 0, 1, 0, 1, 0 ) = matrix.at( 6, 6 );
      this->operator()( 0, 1, 2, 1, 0 ) = matrix.at( 6, 7 );
      this->operator()( 0, 1, 2, 0, 0 ) = matrix.at( 6, 8 );
      this->operator()( 0, 1, 1, 0, 0 ) = matrix.at( 6, 9 );
      this->operator()( 0, 1, 0, 0, 1 ) = matrix.at( 6, 10 );
      this->operator()( 0, 1, 1, 1, 1 ) = matrix.at( 6, 11 );
      this->operator()( 0, 1, 2, 2, 1 ) = matrix.at( 6, 12 );
      this->operator()( 0, 1, 1, 2, 1 ) = matrix.at( 6, 13 );
      this->operator()( 0, 1, 0, 2, 1 ) = matrix.at( 6, 14 );
      this->operator()( 0, 1, 0, 1, 1 ) = matrix.at( 6, 15 );
      this->operator()( 0, 1, 2, 1, 1 ) = matrix.at( 6, 16 );
      this->operator()( 0, 1, 2, 0, 1 ) = matrix.at( 6, 17 );
      this->operator()( 0, 1, 1, 0, 1 ) = matrix.at( 6, 18 );
      this->operator()( 0, 1, 0, 0, 2 ) = matrix.at( 6, 19 );
      this->operator()( 0, 1, 1, 1, 2 ) = matrix.at( 6, 20 );
      this->operator()( 0, 1, 2, 2, 2 ) = matrix.at( 6, 21 );
      this->operator()( 0, 1, 1, 2, 2 ) = matrix.at( 6, 22 );
      this->operator()( 0, 1, 0, 2, 2 ) = matrix.at( 6, 23 );
      this->operator()( 0, 1, 0, 1, 2 ) = matrix.at( 6, 24 );
      this->operator()( 0, 1, 2, 1, 2 ) = matrix.at( 6, 25 );
      this->operator()( 0, 1, 2, 0, 2 ) = matrix.at( 6, 26 );
      this->operator()( 0, 1, 1, 0, 2 ) = matrix.at( 6, 27 );
      this->operator()( 2, 1, 0, 0, 0 ) = matrix.at( 7, 1 );
      this->operator()( 2, 1, 1, 1, 0 ) = matrix.at( 7, 2 );
      this->operator()( 2, 1, 2, 2, 0 ) = matrix.at( 7, 3 );
      this->operator()( 2, 1, 1, 2, 0 ) = matrix.at( 7, 4 );
      this->operator()( 2, 1, 0, 2, 0 ) = matrix.at( 7, 5 );
      this->operator()( 2, 1, 0, 1, 0 ) = matrix.at( 7, 6 );
      this->operator()( 2, 1, 2, 1, 0 ) = matrix.at( 7, 7 );
      this->operator()( 2, 1, 2, 0, 0 ) = matrix.at( 7, 8 );
      this->operator()( 2, 1, 1, 0, 0 ) = matrix.at( 7, 9 );
      this->operator()( 2, 1, 0, 0, 1 ) = matrix.at( 7, 10 );
      this->operator()( 2, 1, 1, 1, 1 ) = matrix.at( 7, 11 );
      this->operator()( 2, 1, 2, 2, 1 ) = matrix.at( 7, 12 );
      this->operator()( 2, 1, 1, 2, 1 ) = matrix.at( 7, 13 );
      this->operator()( 2, 1, 0, 2, 1 ) = matrix.at( 7, 14 );
      this->operator()( 2, 1, 0, 1, 1 ) = matrix.at( 7, 15 );
      this->operator()( 2, 1, 2, 1, 1 ) = matrix.at( 7, 16 );
      this->operator()( 2, 1, 2, 0, 1 ) = matrix.at( 7, 17 );
      this->operator()( 2, 1, 1, 0, 1 ) = matrix.at( 7, 18 );
      this->operator()( 2, 1, 0, 0, 2 ) = matrix.at( 7, 19 );
      this->operator()( 2, 1, 1, 1, 2 ) = matrix.at( 7, 20 );
      this->operator()( 2, 1, 2, 2, 2 ) = matrix.at( 7, 21 );
      this->operator()( 2, 1, 1, 2, 2 ) = matrix.at( 7, 22 );
      this->operator()( 2, 1, 0, 2, 2 ) = matrix.at( 7, 23 );
      this->operator()( 2, 1, 0, 1, 2 ) = matrix.at( 7, 24 );
      this->operator()( 2, 1, 2, 1, 2 ) = matrix.at( 7, 25 );
      this->operator()( 2, 1, 2, 0, 2 ) = matrix.at( 7, 26 );
      this->operator()( 2, 1, 1, 0, 2 ) = matrix.at( 7, 27 );
      this->operator()( 2, 0, 0, 0, 0 ) = matrix.at( 8, 1 );
      this->operator()( 2, 0, 1, 1, 0 ) = matrix.at( 8, 2 );
      this->operator()( 2, 0, 2, 2, 0 ) = matrix.at( 8, 3 );
      this->operator()( 2, 0, 1, 2, 0 ) = matrix.at( 8, 4 );
      this->operator()( 2, 0, 0, 2, 0 ) = matrix.at( 8, 5 );
      this->operator()( 2, 0, 0, 1, 0 ) = matrix.at( 8, 6 );
      this->operator()( 2, 0, 2, 1, 0 ) = matrix.at( 8, 7 );
      this->operator()( 2, 0, 2, 0, 0 ) = matrix.at( 8, 8 );
      this->operator()( 2, 0, 1, 0, 0 ) = matrix.at( 8, 9 );
      this->operator()( 2, 0, 0, 0, 1 ) = matrix.at( 8, 10 );
      this->operator()( 2, 0, 1, 1, 1 ) = matrix.at( 8, 11 );
      this->operator()( 2, 0, 2, 2, 1 ) = matrix.at( 8, 12 );
      this->operator()( 2, 0, 1, 2, 1 ) = matrix.at( 8, 13 );
      this->operator()( 2, 0, 0, 2, 1 ) = matrix.at( 8, 14 );
      this->operator()( 2, 0, 0, 1, 1 ) = matrix.at( 8, 15 );
      this->operator()( 2, 0, 2, 1, 1 ) = matrix.at( 8, 16 );
      this->operator()( 2, 0, 2, 0, 1 ) = matrix.at( 8, 17 );
      this->operator()( 2, 0, 1, 0, 1 ) = matrix.at( 8, 18 );
      this->operator()( 2, 0, 0, 0, 2 ) = matrix.at( 8, 19 );
      this->operator()( 2, 0, 1, 1, 2 ) = matrix.at( 8, 20 );
      this->operator()( 2, 0, 2, 2, 2 ) = matrix.at( 8, 21 );
      this->operator()( 2, 0, 1, 2, 2 ) = matrix.at( 8, 22 );
      this->operator()( 2, 0, 0, 2, 2 ) = matrix.at( 8, 23 );
      this->operator()( 2, 0, 0, 1, 2 ) = matrix.at( 8, 24 );
      this->operator()( 2, 0, 2, 1, 2 ) = matrix.at( 8, 25 );
      this->operator()( 2, 0, 2, 0, 2 ) = matrix.at( 8, 26 );
      this->operator()( 2, 0, 1, 0, 2 ) = matrix.at( 8, 27 );
      this->operator()( 1, 0, 0, 0, 0 ) = matrix.at( 9, 1 );
      this->operator()( 1, 0, 1, 1, 0 ) = matrix.at( 9, 2 );
      this->operator()( 1, 0, 2, 2, 0 ) = matrix.at( 9, 3 );
      this->operator()( 1, 0, 1, 2, 0 ) = matrix.at( 9, 4 );
      this->operator()( 1, 0, 0, 2, 0 ) = matrix.at( 9, 5 );
      this->operator()( 1, 0, 0, 1, 0 ) = matrix.at( 9, 6 );
      this->operator()( 1, 0, 2, 1, 0 ) = matrix.at( 9, 7 );
      this->operator()( 1, 0, 2, 0, 0 ) = matrix.at( 9, 8 );
      this->operator()( 1, 0, 1, 0, 0 ) = matrix.at( 9, 9 );
      this->operator()( 1, 0, 0, 0, 1 ) = matrix.at( 9, 10 );
      this->operator()( 1, 0, 1, 1, 1 ) = matrix.at( 9, 11 );
      this->operator()( 1, 0, 2, 2, 1 ) = matrix.at( 9, 12 );
      this->operator()( 1, 0, 1, 2, 1 ) = matrix.at( 9, 13 );
      this->operator()( 1, 0, 0, 2, 1 ) = matrix.at( 9, 14 );
      this->operator()( 1, 0, 0, 1, 1 ) = matrix.at( 9, 15 );
      this->operator()( 1, 0, 2, 1, 1 ) = matrix.at( 9, 16 );
      this->operator()( 1, 0, 2, 0, 1 ) = matrix.at( 9, 17 );
      this->operator()( 1, 0, 1, 0, 1 ) = matrix.at( 9, 18 );
      this->operator()( 1, 0, 0, 0, 2 ) = matrix.at( 9, 19 );
      this->operator()( 1, 0, 1, 1, 2 ) = matrix.at( 9, 20 );
      this->operator()( 1, 0, 2, 2, 2 ) = matrix.at( 9, 21 );
      this->operator()( 1, 0, 1, 2, 2 ) = matrix.at( 9, 22 );
      this->operator()( 1, 0, 0, 2, 2 ) = matrix.at( 9, 23 );
      this->operator()( 1, 0, 0, 1, 2 ) = matrix.at( 9, 24 );
      this->operator()( 1, 0, 2, 1, 2 ) = matrix.at( 9, 25 );
      this->operator()( 1, 0, 2, 0, 2 ) = matrix.at( 9, 26 );
      this->operator()( 1, 0, 1, 0, 2 ) = matrix.at( 9, 27 );
    }

    /**
     * Creates a fifth-order order tensor in 3d from floatmatrixf<27, 9>
     */

    Tensor5_3d( const FloatMatrixF<27, 9> &matrix )
    {

      this->operator()( 0, 0, 0, 0, 0 ) = matrix.at( 1, 1 );
      this->operator()( 1, 1, 0, 0, 0 ) = matrix.at( 2, 1 );
      this->operator()( 2, 2, 0, 0, 0 ) = matrix.at( 3, 1 );
      this->operator()( 1, 2, 0, 0, 0 ) = matrix.at( 4, 1 );
      this->operator()( 0, 2, 0, 0, 0 ) = matrix.at( 5, 1 );
      this->operator()( 0, 1, 0, 0, 0 ) = matrix.at( 6, 1 );
      this->operator()( 2, 1, 0, 0, 0 ) = matrix.at( 7, 1 );
      this->operator()( 2, 0, 0, 0, 0 ) = matrix.at( 8, 1 );
      this->operator()( 1, 0, 0, 0, 0 ) = matrix.at( 9, 1 );
      this->operator()( 0, 0, 1, 0, 0 ) = matrix.at( 10, 1 );
      this->operator()( 1, 1, 1, 0, 0 ) = matrix.at( 11, 1 );
      this->operator()( 2, 2, 1, 0, 0 ) = matrix.at( 12, 1 );
      this->operator()( 1, 2, 1, 0, 0 ) = matrix.at( 13, 1 );
      this->operator()( 0, 2, 1, 0, 0 ) = matrix.at( 14, 1 );
      this->operator()( 0, 1, 1, 0, 0 ) = matrix.at( 15, 1 );
      this->operator()( 2, 1, 1, 0, 0 ) = matrix.at( 16, 1 );
      this->operator()( 2, 0, 1, 0, 0 ) = matrix.at( 17, 1 );
      this->operator()( 1, 0, 1, 0, 0 ) = matrix.at( 18, 1 );
      this->operator()( 0, 0, 2, 0, 0 ) = matrix.at( 19, 1 );
      this->operator()( 1, 1, 2, 0, 0 ) = matrix.at( 20, 1 );
      this->operator()( 2, 2, 2, 0, 0 ) = matrix.at( 21, 1 );
      this->operator()( 1, 2, 2, 0, 0 ) = matrix.at( 22, 1 );
      this->operator()( 0, 2, 2, 0, 0 ) = matrix.at( 23, 1 );
      this->operator()( 0, 1, 2, 0, 0 ) = matrix.at( 24, 1 );
      this->operator()( 2, 1, 2, 0, 0 ) = matrix.at( 25, 1 );
      this->operator()( 2, 0, 2, 0, 0 ) = matrix.at( 26, 1 );
      this->operator()( 1, 0, 2, 0, 0 ) = matrix.at( 27, 1 );
      this->operator()( 0, 0, 0, 1, 1 ) = matrix.at( 1, 2 );
      this->operator()( 1, 1, 0, 1, 1 ) = matrix.at( 2, 2 );
      this->operator()( 2, 2, 0, 1, 1 ) = matrix.at( 3, 2 );
      this->operator()( 1, 2, 0, 1, 1 ) = matrix.at( 4, 2 );
      this->operator()( 0, 2, 0, 1, 1 ) = matrix.at( 5, 2 );
      this->operator()( 0, 1, 0, 1, 1 ) = matrix.at( 6, 2 );
      this->operator()( 2, 1, 0, 1, 1 ) = matrix.at( 7, 2 );
      this->operator()( 2, 0, 0, 1, 1 ) = matrix.at( 8, 2 );
      this->operator()( 1, 0, 0, 1, 1 ) = matrix.at( 9, 2 );
      this->operator()( 0, 0, 1, 1, 1 ) = matrix.at( 10, 2 );
      this->operator()( 1, 1, 1, 1, 1 ) = matrix.at( 11, 2 );
      this->operator()( 2, 2, 1, 1, 1 ) = matrix.at( 12, 2 );
      this->operator()( 1, 2, 1, 1, 1 ) = matrix.at( 13, 2 );
      this->operator()( 0, 2, 1, 1, 1 ) = matrix.at( 14, 2 );
      this->operator()( 0, 1, 1, 1, 1 ) = matrix.at( 15, 2 );
      this->operator()( 2, 1, 1, 1, 1 ) = matrix.at( 16, 2 );
      this->operator()( 2, 0, 1, 1, 1 ) = matrix.at( 17, 2 );
      this->operator()( 1, 0, 1, 1, 1 ) = matrix.at( 18, 2 );
      this->operator()( 0, 0, 2, 1, 1 ) = matrix.at( 19, 2 );
      this->operator()( 1, 1, 2, 1, 1 ) = matrix.at( 20, 2 );
      this->operator()( 2, 2, 2, 1, 1 ) = matrix.at( 21, 2 );
      this->operator()( 1, 2, 2, 1, 1 ) = matrix.at( 22, 2 );
      this->operator()( 0, 2, 2, 1, 1 ) = matrix.at( 23, 2 );
      this->operator()( 0, 1, 2, 1, 1 ) = matrix.at( 24, 2 );
      this->operator()( 2, 1, 2, 1, 1 ) = matrix.at( 25, 2 );
      this->operator()( 2, 0, 2, 1, 1 ) = matrix.at( 26, 2 );
      this->operator()( 1, 0, 2, 1, 1 ) = matrix.at( 27, 2 );
      this->operator()( 0, 0, 0, 2, 2 ) = matrix.at( 1, 3 );
      this->operator()( 1, 1, 0, 2, 2 ) = matrix.at( 2, 3 );
      this->operator()( 2, 2, 0, 2, 2 ) = matrix.at( 3, 3 );
      this->operator()( 1, 2, 0, 2, 2 ) = matrix.at( 4, 3 );
      this->operator()( 0, 2, 0, 2, 2 ) = matrix.at( 5, 3 );
      this->operator()( 0, 1, 0, 2, 2 ) = matrix.at( 6, 3 );
      this->operator()( 2, 1, 0, 2, 2 ) = matrix.at( 7, 3 );
      this->operator()( 2, 0, 0, 2, 2 ) = matrix.at( 8, 3 );
      this->operator()( 1, 0, 0, 2, 2 ) = matrix.at( 9, 3 );
      this->operator()( 0, 0, 1, 2, 2 ) = matrix.at( 10, 3 );
      this->operator()( 1, 1, 1, 2, 2 ) = matrix.at( 11, 3 );
      this->operator()( 2, 2, 1, 2, 2 ) = matrix.at( 12, 3 );
      this->operator()( 1, 2, 1, 2, 2 ) = matrix.at( 13, 3 );
      this->operator()( 0, 2, 1, 2, 2 ) = matrix.at( 14, 3 );
      this->operator()( 0, 1, 1, 2, 2 ) = matrix.at( 15, 3 );
      this->operator()( 2, 1, 1, 2, 2 ) = matrix.at( 16, 3 );
      this->operator()( 2, 0, 1, 2, 2 ) = matrix.at( 17, 3 );
      this->operator()( 1, 0, 1, 2, 2 ) = matrix.at( 18, 3 );
      this->operator()( 0, 0, 2, 2, 2 ) = matrix.at( 19, 3 );
      this->operator()( 1, 1, 2, 2, 2 ) = matrix.at( 20, 3 );
      this->operator()( 2, 2, 2, 2, 2 ) = matrix.at( 21, 3 );
      this->operator()( 1, 2, 2, 2, 2 ) = matrix.at( 22, 3 );
      this->operator()( 0, 2, 2, 2, 2 ) = matrix.at( 23, 3 );
      this->operator()( 0, 1, 2, 2, 2 ) = matrix.at( 24, 3 );
      this->operator()( 2, 1, 2, 2, 2 ) = matrix.at( 25, 3 );
      this->operator()( 2, 0, 2, 2, 2 ) = matrix.at( 26, 3 );
      this->operator()( 1, 0, 2, 2, 2 ) = matrix.at( 27, 3 );
      this->operator()( 0, 0, 0, 1, 2 ) = matrix.at( 1, 4 );
      this->operator()( 1, 1, 0, 1, 2 ) = matrix.at( 2, 4 );
      this->operator()( 2, 2, 0, 1, 2 ) = matrix.at( 3, 4 );
      this->operator()( 1, 2, 0, 1, 2 ) = matrix.at( 4, 4 );
      this->operator()( 0, 2, 0, 1, 2 ) = matrix.at( 5, 4 );
      this->operator()( 0, 1, 0, 1, 2 ) = matrix.at( 6, 4 );
      this->operator()( 2, 1, 0, 1, 2 ) = matrix.at( 7, 4 );
      this->operator()( 2, 0, 0, 1, 2 ) = matrix.at( 8, 4 );
      this->operator()( 1, 0, 0, 1, 2 ) = matrix.at( 9, 4 );
      this->operator()( 0, 0, 1, 1, 2 ) = matrix.at( 10, 4 );
      this->operator()( 1, 1, 1, 1, 2 ) = matrix.at( 11, 4 );
      this->operator()( 2, 2, 1, 1, 2 ) = matrix.at( 12, 4 );
      this->operator()( 1, 2, 1, 1, 2 ) = matrix.at( 13, 4 );
      this->operator()( 0, 2, 1, 1, 2 ) = matrix.at( 14, 4 );
      this->operator()( 0, 1, 1, 1, 2 ) = matrix.at( 15, 4 );
      this->operator()( 2, 1, 1, 1, 2 ) = matrix.at( 16, 4 );
      this->operator()( 2, 0, 1, 1, 2 ) = matrix.at( 17, 4 );
      this->operator()( 1, 0, 1, 1, 2 ) = matrix.at( 18, 4 );
      this->operator()( 0, 0, 2, 1, 2 ) = matrix.at( 19, 4 );
      this->operator()( 1, 1, 2, 1, 2 ) = matrix.at( 20, 4 );
      this->operator()( 2, 2, 2, 1, 2 ) = matrix.at( 21, 4 );
      this->operator()( 1, 2, 2, 1, 2 ) = matrix.at( 22, 4 );
      this->operator()( 0, 2, 2, 1, 2 ) = matrix.at( 23, 4 );
      this->operator()( 0, 1, 2, 1, 2 ) = matrix.at( 24, 4 );
      this->operator()( 2, 1, 2, 1, 2 ) = matrix.at( 25, 4 );
      this->operator()( 2, 0, 2, 1, 2 ) = matrix.at( 26, 4 );
      this->operator()( 1, 0, 2, 1, 2 ) = matrix.at( 27, 4 );
      this->operator()( 0, 0, 0, 0, 2 ) = matrix.at( 1, 5 );
      this->operator()( 1, 1, 0, 0, 2 ) = matrix.at( 2, 5 );
      this->operator()( 2, 2, 0, 0, 2 ) = matrix.at( 3, 5 );
      this->operator()( 1, 2, 0, 0, 2 ) = matrix.at( 4, 5 );
      this->operator()( 0, 2, 0, 0, 2 ) = matrix.at( 5, 5 );
      this->operator()( 0, 1, 0, 0, 2 ) = matrix.at( 6, 5 );
      this->operator()( 2, 1, 0, 0, 2 ) = matrix.at( 7, 5 );
      this->operator()( 2, 0, 0, 0, 2 ) = matrix.at( 8, 5 );
      this->operator()( 1, 0, 0, 0, 2 ) = matrix.at( 9, 5 );
      this->operator()( 0, 0, 1, 0, 2 ) = matrix.at( 10, 5 );
      this->operator()( 1, 1, 1, 0, 2 ) = matrix.at( 11, 5 );
      this->operator()( 2, 2, 1, 0, 2 ) = matrix.at( 12, 5 );
      this->operator()( 1, 2, 1, 0, 2 ) = matrix.at( 13, 5 );
      this->operator()( 0, 2, 1, 0, 2 ) = matrix.at( 14, 5 );
      this->operator()( 0, 1, 1, 0, 2 ) = matrix.at( 15, 5 );
      this->operator()( 2, 1, 1, 0, 2 ) = matrix.at( 16, 5 );
      this->operator()( 2, 0, 1, 0, 2 ) = matrix.at( 17, 5 );
      this->operator()( 1, 0, 1, 0, 2 ) = matrix.at( 18, 5 );
      this->operator()( 0, 0, 2, 0, 2 ) = matrix.at( 19, 5 );
      this->operator()( 1, 1, 2, 0, 2 ) = matrix.at( 20, 5 );
      this->operator()( 2, 2, 2, 0, 2 ) = matrix.at( 21, 5 );
      this->operator()( 1, 2, 2, 0, 2 ) = matrix.at( 22, 5 );
      this->operator()( 0, 2, 2, 0, 2 ) = matrix.at( 23, 5 );
      this->operator()( 0, 1, 2, 0, 2 ) = matrix.at( 24, 5 );
      this->operator()( 2, 1, 2, 0, 2 ) = matrix.at( 25, 5 );
      this->operator()( 2, 0, 2, 0, 2 ) = matrix.at( 26, 5 );
      this->operator()( 1, 0, 2, 0, 2 ) = matrix.at( 27, 5 );
      this->operator()( 0, 0, 0, 0, 1 ) = matrix.at( 1, 6 );
      this->operator()( 1, 1, 0, 0, 1 ) = matrix.at( 2, 6 );
      this->operator()( 2, 2, 0, 0, 1 ) = matrix.at( 3, 6 );
      this->operator()( 1, 2, 0, 0, 1 ) = matrix.at( 4, 6 );
      this->operator()( 0, 2, 0, 0, 1 ) = matrix.at( 5, 6 );
      this->operator()( 0, 1, 0, 0, 1 ) = matrix.at( 6, 6 );
      this->operator()( 2, 1, 0, 0, 1 ) = matrix.at( 7, 6 );
      this->operator()( 2, 0, 0, 0, 1 ) = matrix.at( 8, 6 );
      this->operator()( 1, 0, 0, 0, 1 ) = matrix.at( 9, 6 );
      this->operator()( 0, 0, 1, 0, 1 ) = matrix.at( 10, 6 );
      this->operator()( 1, 1, 1, 0, 1 ) = matrix.at( 11, 6 );
      this->operator()( 2, 2, 1, 0, 1 ) = matrix.at( 12, 6 );
      this->operator()( 1, 2, 1, 0, 1 ) = matrix.at( 13, 6 );
      this->operator()( 0, 2, 1, 0, 1 ) = matrix.at( 14, 6 );
      this->operator()( 0, 1, 1, 0, 1 ) = matrix.at( 15, 6 );
      this->operator()( 2, 1, 1, 0, 1 ) = matrix.at( 16, 6 );
      this->operator()( 2, 0, 1, 0, 1 ) = matrix.at( 17, 6 );
      this->operator()( 1, 0, 1, 0, 1 ) = matrix.at( 18, 6 );
      this->operator()( 0, 0, 2, 0, 1 ) = matrix.at( 19, 6 );
      this->operator()( 1, 1, 2, 0, 1 ) = matrix.at( 20, 6 );
      this->operator()( 2, 2, 2, 0, 1 ) = matrix.at( 21, 6 );
      this->operator()( 1, 2, 2, 0, 1 ) = matrix.at( 22, 6 );
      this->operator()( 0, 2, 2, 0, 1 ) = matrix.at( 23, 6 );
      this->operator()( 0, 1, 2, 0, 1 ) = matrix.at( 24, 6 );
      this->operator()( 2, 1, 2, 0, 1 ) = matrix.at( 25, 6 );
      this->operator()( 2, 0, 2, 0, 1 ) = matrix.at( 26, 6 );
      this->operator()( 1, 0, 2, 0, 1 ) = matrix.at( 27, 6 );
      this->operator()( 0, 0, 0, 2, 1 ) = matrix.at( 1, 7 );
      this->operator()( 1, 1, 0, 2, 1 ) = matrix.at( 2, 7 );
      this->operator()( 2, 2, 0, 2, 1 ) = matrix.at( 3, 7 );
      this->operator()( 1, 2, 0, 2, 1 ) = matrix.at( 4, 7 );
      this->operator()( 0, 2, 0, 2, 1 ) = matrix.at( 5, 7 );
      this->operator()( 0, 1, 0, 2, 1 ) = matrix.at( 6, 7 );
      this->operator()( 2, 1, 0, 2, 1 ) = matrix.at( 7, 7 );
      this->operator()( 2, 0, 0, 2, 1 ) = matrix.at( 8, 7 );
      this->operator()( 1, 0, 0, 2, 1 ) = matrix.at( 9, 7 );
      this->operator()( 0, 0, 1, 2, 1 ) = matrix.at( 10, 7 );
      this->operator()( 1, 1, 1, 2, 1 ) = matrix.at( 11, 7 );
      this->operator()( 2, 2, 1, 2, 1 ) = matrix.at( 12, 7 );
      this->operator()( 1, 2, 1, 2, 1 ) = matrix.at( 13, 7 );
      this->operator()( 0, 2, 1, 2, 1 ) = matrix.at( 14, 7 );
      this->operator()( 0, 1, 1, 2, 1 ) = matrix.at( 15, 7 );
      this->operator()( 2, 1, 1, 2, 1 ) = matrix.at( 16, 7 );
      this->operator()( 2, 0, 1, 2, 1 ) = matrix.at( 17, 7 );
      this->operator()( 1, 0, 1, 2, 1 ) = matrix.at( 18, 7 );
      this->operator()( 0, 0, 2, 2, 1 ) = matrix.at( 19, 7 );
      this->operator()( 1, 1, 2, 2, 1 ) = matrix.at( 20, 7 );
      this->operator()( 2, 2, 2, 2, 1 ) = matrix.at( 21, 7 );
      this->operator()( 1, 2, 2, 2, 1 ) = matrix.at( 22, 7 );
      this->operator()( 0, 2, 2, 2, 1 ) = matrix.at( 23, 7 );
      this->operator()( 0, 1, 2, 2, 1 ) = matrix.at( 24, 7 );
      this->operator()( 2, 1, 2, 2, 1 ) = matrix.at( 25, 7 );
      this->operator()( 2, 0, 2, 2, 1 ) = matrix.at( 26, 7 );
      this->operator()( 1, 0, 2, 2, 1 ) = matrix.at( 27, 7 );
      this->operator()( 0, 0, 0, 2, 0 ) = matrix.at( 1, 8 );
      this->operator()( 1, 1, 0, 2, 0 ) = matrix.at( 2, 8 );
      this->operator()( 2, 2, 0, 2, 0 ) = matrix.at( 3, 8 );
      this->operator()( 1, 2, 0, 2, 0 ) = matrix.at( 4, 8 );
      this->operator()( 0, 2, 0, 2, 0 ) = matrix.at( 5, 8 );
      this->operator()( 0, 1, 0, 2, 0 ) = matrix.at( 6, 8 );
      this->operator()( 2, 1, 0, 2, 0 ) = matrix.at( 7, 8 );
      this->operator()( 2, 0, 0, 2, 0 ) = matrix.at( 8, 8 );
      this->operator()( 1, 0, 0, 2, 0 ) = matrix.at( 9, 8 );
      this->operator()( 0, 0, 1, 2, 0 ) = matrix.at( 10, 8 );
      this->operator()( 1, 1, 1, 2, 0 ) = matrix.at( 11, 8 );
      this->operator()( 2, 2, 1, 2, 0 ) = matrix.at( 12, 8 );
      this->operator()( 1, 2, 1, 2, 0 ) = matrix.at( 13, 8 );
      this->operator()( 0, 2, 1, 2, 0 ) = matrix.at( 14, 8 );
      this->operator()( 0, 1, 1, 2, 0 ) = matrix.at( 15, 8 );
      this->operator()( 2, 1, 1, 2, 0 ) = matrix.at( 16, 8 );
      this->operator()( 2, 0, 1, 2, 0 ) = matrix.at( 17, 8 );
      this->operator()( 1, 0, 1, 2, 0 ) = matrix.at( 18, 8 );
      this->operator()( 0, 0, 2, 2, 0 ) = matrix.at( 19, 8 );
      this->operator()( 1, 1, 2, 2, 0 ) = matrix.at( 20, 8 );
      this->operator()( 2, 2, 2, 2, 0 ) = matrix.at( 21, 8 );
      this->operator()( 1, 2, 2, 2, 0 ) = matrix.at( 22, 8 );
      this->operator()( 0, 2, 2, 2, 0 ) = matrix.at( 23, 8 );
      this->operator()( 0, 1, 2, 2, 0 ) = matrix.at( 24, 8 );
      this->operator()( 2, 1, 2, 2, 0 ) = matrix.at( 25, 8 );
      this->operator()( 2, 0, 2, 2, 0 ) = matrix.at( 26, 8 );
      this->operator()( 1, 0, 2, 2, 0 ) = matrix.at( 27, 8 );
      this->operator()( 0, 0, 0, 1, 0 ) = matrix.at( 1, 9 );
      this->operator()( 1, 1, 0, 1, 0 ) = matrix.at( 2, 9 );
      this->operator()( 2, 2, 0, 1, 0 ) = matrix.at( 3, 9 );
      this->operator()( 1, 2, 0, 1, 0 ) = matrix.at( 4, 9 );
      this->operator()( 0, 2, 0, 1, 0 ) = matrix.at( 5, 9 );
      this->operator()( 0, 1, 0, 1, 0 ) = matrix.at( 6, 9 );
      this->operator()( 2, 1, 0, 1, 0 ) = matrix.at( 7, 9 );
      this->operator()( 2, 0, 0, 1, 0 ) = matrix.at( 8, 9 );
      this->operator()( 1, 0, 0, 1, 0 ) = matrix.at( 9, 9 );
      this->operator()( 0, 0, 1, 1, 0 ) = matrix.at( 10, 9 );
      this->operator()( 1, 1, 1, 1, 0 ) = matrix.at( 11, 9 );
      this->operator()( 2, 2, 1, 1, 0 ) = matrix.at( 12, 9 );
      this->operator()( 1, 2, 1, 1, 0 ) = matrix.at( 13, 9 );
      this->operator()( 0, 2, 1, 1, 0 ) = matrix.at( 14, 9 );
      this->operator()( 0, 1, 1, 1, 0 ) = matrix.at( 15, 9 );
      this->operator()( 2, 1, 1, 1, 0 ) = matrix.at( 16, 9 );
      this->operator()( 2, 0, 1, 1, 0 ) = matrix.at( 17, 9 );
      this->operator()( 1, 0, 1, 1, 0 ) = matrix.at( 18, 9 );
      this->operator()( 0, 0, 2, 1, 0 ) = matrix.at( 19, 9 );
      this->operator()( 1, 1, 2, 1, 0 ) = matrix.at( 20, 9 );
      this->operator()( 2, 2, 2, 1, 0 ) = matrix.at( 21, 9 );
      this->operator()( 1, 2, 2, 1, 0 ) = matrix.at( 22, 9 );
      this->operator()( 0, 2, 2, 1, 0 ) = matrix.at( 23, 9 );
      this->operator()( 0, 1, 2, 1, 0 ) = matrix.at( 24, 9 );
      this->operator()( 2, 1, 2, 1, 0 ) = matrix.at( 25, 9 );
      this->operator()( 2, 0, 2, 1, 0 ) = matrix.at( 26, 9 );
      this->operator()( 1, 0, 2, 1, 0 ) = matrix.at( 27, 9 );
    }


    /**
     * Transforms a fifth-order tensor into a floatmatrixf<9, 27>,  using the Voigt notation
     */

    const inline FloatMatrixF<9, 27> to_voigt_form_9x27()
    {
      FloatMatrixF<9, 27> answer;
      answer.at( 1, 1 ) = this->operator()( 0, 0, 0, 0, 0 );
      answer.at( 1, 2 ) = this->operator()( 0, 0, 1, 1, 0 );
      answer.at( 1, 3 ) = this->operator()( 0, 0, 2, 2, 0 );
      answer.at( 1, 4 ) = this->operator()( 0, 0, 1, 2, 0 );
      answer.at( 1, 5 ) = this->operator()( 0, 0, 0, 2, 0 );
      answer.at( 1, 6 ) = this->operator()( 0, 0, 0, 1, 0 );
      answer.at( 1, 7 ) = this->operator()( 0, 0, 2, 1, 0 );
      answer.at( 1, 8 ) = this->operator()( 0, 0, 2, 0, 0 );
      answer.at( 1, 9 ) = this->operator()( 0, 0, 1, 0, 0 );
      answer.at( 1, 10 ) = this->operator()( 0, 0, 0, 0, 1 );
      answer.at( 1, 11 ) = this->operator()( 0, 0, 1, 1, 1 );
      answer.at( 1, 12 ) = this->operator()( 0, 0, 2, 2, 1 );
      answer.at( 1, 13 ) = this->operator()( 0, 0, 1, 2, 1 );
      answer.at( 1, 14 ) = this->operator()( 0, 0, 0, 2, 1 );
      answer.at( 1, 15 ) = this->operator()( 0, 0, 0, 1, 1 );
      answer.at( 1, 16 ) = this->operator()( 0, 0, 2, 1, 1 );
      answer.at( 1, 17 ) = this->operator()( 0, 0, 2, 0, 1 );
      answer.at( 1, 18 ) = this->operator()( 0, 0, 1, 0, 1 );
      answer.at( 1, 19 ) = this->operator()( 0, 0, 0, 0, 2 );
      answer.at( 1, 20 ) = this->operator()( 0, 0, 1, 1, 2 );
      answer.at( 1, 21 ) = this->operator()( 0, 0, 2, 2, 2 );
      answer.at( 1, 22 ) = this->operator()( 0, 0, 1, 2, 2 );
      answer.at( 1, 23 ) = this->operator()( 0, 0, 0, 2, 2 );
      answer.at( 1, 24 ) = this->operator()( 0, 0, 0, 1, 2 );
      answer.at( 1, 25 ) = this->operator()( 0, 0, 2, 1, 2 );
      answer.at( 1, 26 ) = this->operator()( 0, 0, 2, 0, 2 );
      answer.at( 1, 27 ) = this->operator()( 0, 0, 1, 0, 2 );
      answer.at( 2, 1 ) = this->operator()( 1, 1, 0, 0, 0 );
      answer.at( 2, 2 ) = this->operator()( 1, 1, 1, 1, 0 );
      answer.at( 2, 3 ) = this->operator()( 1, 1, 2, 2, 0 );
      answer.at( 2, 4 ) = this->operator()( 1, 1, 1, 2, 0 );
      answer.at( 2, 5 ) = this->operator()( 1, 1, 0, 2, 0 );
      answer.at( 2, 6 ) = this->operator()( 1, 1, 0, 1, 0 );
      answer.at( 2, 7 ) = this->operator()( 1, 1, 2, 1, 0 );
      answer.at( 2, 8 ) = this->operator()( 1, 1, 2, 0, 0 );
      answer.at( 2, 9 ) = this->operator()( 1, 1, 1, 0, 0 );
      answer.at( 2, 10 ) = this->operator()( 1, 1, 0, 0, 1 );
      answer.at( 2, 11 ) = this->operator()( 1, 1, 1, 1, 1 );
      answer.at( 2, 12 ) = this->operator()( 1, 1, 2, 2, 1 );
      answer.at( 2, 13 ) = this->operator()( 1, 1, 1, 2, 1 );
      answer.at( 2, 14 ) = this->operator()( 1, 1, 0, 2, 1 );
      answer.at( 2, 15 ) = this->operator()( 1, 1, 0, 1, 1 );
      answer.at( 2, 16 ) = this->operator()( 1, 1, 2, 1, 1 );
      answer.at( 2, 17 ) = this->operator()( 1, 1, 2, 0, 1 );
      answer.at( 2, 18 ) = this->operator()( 1, 1, 1, 0, 1 );
      answer.at( 2, 19 ) = this->operator()( 1, 1, 0, 0, 2 );
      answer.at( 2, 20 ) = this->operator()( 1, 1, 1, 1, 2 );
      answer.at( 2, 21 ) = this->operator()( 1, 1, 2, 2, 2 );
      answer.at( 2, 22 ) = this->operator()( 1, 1, 1, 2, 2 );
      answer.at( 2, 23 ) = this->operator()( 1, 1, 0, 2, 2 );
      answer.at( 2, 24 ) = this->operator()( 1, 1, 0, 1, 2 );
      answer.at( 2, 25 ) = this->operator()( 1, 1, 2, 1, 2 );
      answer.at( 2, 26 ) = this->operator()( 1, 1, 2, 0, 2 );
      answer.at( 2, 27 ) = this->operator()( 1, 1, 1, 0, 2 );
      answer.at( 3, 1 ) = this->operator()( 2, 2, 0, 0, 0 );
      answer.at( 3, 2 ) = this->operator()( 2, 2, 1, 1, 0 );
      answer.at( 3, 3 ) = this->operator()( 2, 2, 2, 2, 0 );
      answer.at( 3, 4 ) = this->operator()( 2, 2, 1, 2, 0 );
      answer.at( 3, 5 ) = this->operator()( 2, 2, 0, 2, 0 );
      answer.at( 3, 6 ) = this->operator()( 2, 2, 0, 1, 0 );
      answer.at( 3, 7 ) = this->operator()( 2, 2, 2, 1, 0 );
      answer.at( 3, 8 ) = this->operator()( 2, 2, 2, 0, 0 );
      answer.at( 3, 9 ) = this->operator()( 2, 2, 1, 0, 0 );
      answer.at( 3, 10 ) = this->operator()( 2, 2, 0, 0, 1 );
      answer.at( 3, 11 ) = this->operator()( 2, 2, 1, 1, 1 );
      answer.at( 3, 12 ) = this->operator()( 2, 2, 2, 2, 1 );
      answer.at( 3, 13 ) = this->operator()( 2, 2, 1, 2, 1 );
      answer.at( 3, 14 ) = this->operator()( 2, 2, 0, 2, 1 );
      answer.at( 3, 15 ) = this->operator()( 2, 2, 0, 1, 1 );
      answer.at( 3, 16 ) = this->operator()( 2, 2, 2, 1, 1 );
      answer.at( 3, 17 ) = this->operator()( 2, 2, 2, 0, 1 );
      answer.at( 3, 18 ) = this->operator()( 2, 2, 1, 0, 1 );
      answer.at( 3, 19 ) = this->operator()( 2, 2, 0, 0, 2 );
      answer.at( 3, 20 ) = this->operator()( 2, 2, 1, 1, 2 );
      answer.at( 3, 21 ) = this->operator()( 2, 2, 2, 2, 2 );
      answer.at( 3, 22 ) = this->operator()( 2, 2, 1, 2, 2 );
      answer.at( 3, 23 ) = this->operator()( 2, 2, 0, 2, 2 );
      answer.at( 3, 24 ) = this->operator()( 2, 2, 0, 1, 2 );
      answer.at( 3, 25 ) = this->operator()( 2, 2, 2, 1, 2 );
      answer.at( 3, 26 ) = this->operator()( 2, 2, 2, 0, 2 );
      answer.at( 3, 27 ) = this->operator()( 2, 2, 1, 0, 2 );
      answer.at( 4, 1 ) = this->operator()( 1, 2, 0, 0, 0 );
      answer.at( 4, 2 ) = this->operator()( 1, 2, 1, 1, 0 );
      answer.at( 4, 3 ) = this->operator()( 1, 2, 2, 2, 0 );
      answer.at( 4, 4 ) = this->operator()( 1, 2, 1, 2, 0 );
      answer.at( 4, 5 ) = this->operator()( 1, 2, 0, 2, 0 );
      answer.at( 4, 6 ) = this->operator()( 1, 2, 0, 1, 0 );
      answer.at( 4, 7 ) = this->operator()( 1, 2, 2, 1, 0 );
      answer.at( 4, 8 ) = this->operator()( 1, 2, 2, 0, 0 );
      answer.at( 4, 9 ) = this->operator()( 1, 2, 1, 0, 0 );
      answer.at( 4, 10 ) = this->operator()( 1, 2, 0, 0, 1 );
      answer.at( 4, 11 ) = this->operator()( 1, 2, 1, 1, 1 );
      answer.at( 4, 12 ) = this->operator()( 1, 2, 2, 2, 1 );
      answer.at( 4, 13 ) = this->operator()( 1, 2, 1, 2, 1 );
      answer.at( 4, 14 ) = this->operator()( 1, 2, 0, 2, 1 );
      answer.at( 4, 15 ) = this->operator()( 1, 2, 0, 1, 1 );
      answer.at( 4, 16 ) = this->operator()( 1, 2, 2, 1, 1 );
      answer.at( 4, 17 ) = this->operator()( 1, 2, 2, 0, 1 );
      answer.at( 4, 18 ) = this->operator()( 1, 2, 1, 0, 1 );
      answer.at( 4, 19 ) = this->operator()( 1, 2, 0, 0, 2 );
      answer.at( 4, 20 ) = this->operator()( 1, 2, 1, 1, 2 );
      answer.at( 4, 21 ) = this->operator()( 1, 2, 2, 2, 2 );
      answer.at( 4, 22 ) = this->operator()( 1, 2, 1, 2, 2 );
      answer.at( 4, 23 ) = this->operator()( 1, 2, 0, 2, 2 );
      answer.at( 4, 24 ) = this->operator()( 1, 2, 0, 1, 2 );
      answer.at( 4, 25 ) = this->operator()( 1, 2, 2, 1, 2 );
      answer.at( 4, 26 ) = this->operator()( 1, 2, 2, 0, 2 );
      answer.at( 4, 27 ) = this->operator()( 1, 2, 1, 0, 2 );
      answer.at( 5, 1 ) = this->operator()( 0, 2, 0, 0, 0 );
      answer.at( 5, 2 ) = this->operator()( 0, 2, 1, 1, 0 );
      answer.at( 5, 3 ) = this->operator()( 0, 2, 2, 2, 0 );
      answer.at( 5, 4 ) = this->operator()( 0, 2, 1, 2, 0 );
      answer.at( 5, 5 ) = this->operator()( 0, 2, 0, 2, 0 );
      answer.at( 5, 6 ) = this->operator()( 0, 2, 0, 1, 0 );
      answer.at( 5, 7 ) = this->operator()( 0, 2, 2, 1, 0 );
      answer.at( 5, 8 ) = this->operator()( 0, 2, 2, 0, 0 );
      answer.at( 5, 9 ) = this->operator()( 0, 2, 1, 0, 0 );
      answer.at( 5, 10 ) = this->operator()( 0, 2, 0, 0, 1 );
      answer.at( 5, 11 ) = this->operator()( 0, 2, 1, 1, 1 );
      answer.at( 5, 12 ) = this->operator()( 0, 2, 2, 2, 1 );
      answer.at( 5, 13 ) = this->operator()( 0, 2, 1, 2, 1 );
      answer.at( 5, 14 ) = this->operator()( 0, 2, 0, 2, 1 );
      answer.at( 5, 15 ) = this->operator()( 0, 2, 0, 1, 1 );
      answer.at( 5, 16 ) = this->operator()( 0, 2, 2, 1, 1 );
      answer.at( 5, 17 ) = this->operator()( 0, 2, 2, 0, 1 );
      answer.at( 5, 18 ) = this->operator()( 0, 2, 1, 0, 1 );
      answer.at( 5, 19 ) = this->operator()( 0, 2, 0, 0, 2 );
      answer.at( 5, 20 ) = this->operator()( 0, 2, 1, 1, 2 );
      answer.at( 5, 21 ) = this->operator()( 0, 2, 2, 2, 2 );
      answer.at( 5, 22 ) = this->operator()( 0, 2, 1, 2, 2 );
      answer.at( 5, 23 ) = this->operator()( 0, 2, 0, 2, 2 );
      answer.at( 5, 24 ) = this->operator()( 0, 2, 0, 1, 2 );
      answer.at( 5, 25 ) = this->operator()( 0, 2, 2, 1, 2 );
      answer.at( 5, 26 ) = this->operator()( 0, 2, 2, 0, 2 );
      answer.at( 5, 27 ) = this->operator()( 0, 2, 1, 0, 2 );
      answer.at( 6, 1 ) = this->operator()( 0, 1, 0, 0, 0 );
      answer.at( 6, 2 ) = this->operator()( 0, 1, 1, 1, 0 );
      answer.at( 6, 3 ) = this->operator()( 0, 1, 2, 2, 0 );
      answer.at( 6, 4 ) = this->operator()( 0, 1, 1, 2, 0 );
      answer.at( 6, 5 ) = this->operator()( 0, 1, 0, 2, 0 );
      answer.at( 6, 6 ) = this->operator()( 0, 1, 0, 1, 0 );
      answer.at( 6, 7 ) = this->operator()( 0, 1, 2, 1, 0 );
      answer.at( 6, 8 ) = this->operator()( 0, 1, 2, 0, 0 );
      answer.at( 6, 9 ) = this->operator()( 0, 1, 1, 0, 0 );
      answer.at( 6, 10 ) = this->operator()( 0, 1, 0, 0, 1 );
      answer.at( 6, 11 ) = this->operator()( 0, 1, 1, 1, 1 );
      answer.at( 6, 12 ) = this->operator()( 0, 1, 2, 2, 1 );
      answer.at( 6, 13 ) = this->operator()( 0, 1, 1, 2, 1 );
      answer.at( 6, 14 ) = this->operator()( 0, 1, 0, 2, 1 );
      answer.at( 6, 15 ) = this->operator()( 0, 1, 0, 1, 1 );
      answer.at( 6, 16 ) = this->operator()( 0, 1, 2, 1, 1 );
      answer.at( 6, 17 ) = this->operator()( 0, 1, 2, 0, 1 );
      answer.at( 6, 18 ) = this->operator()( 0, 1, 1, 0, 1 );
      answer.at( 6, 19 ) = this->operator()( 0, 1, 0, 0, 2 );
      answer.at( 6, 20 ) = this->operator()( 0, 1, 1, 1, 2 );
      answer.at( 6, 21 ) = this->operator()( 0, 1, 2, 2, 2 );
      answer.at( 6, 22 ) = this->operator()( 0, 1, 1, 2, 2 );
      answer.at( 6, 23 ) = this->operator()( 0, 1, 0, 2, 2 );
      answer.at( 6, 24 ) = this->operator()( 0, 1, 0, 1, 2 );
      answer.at( 6, 25 ) = this->operator()( 0, 1, 2, 1, 2 );
      answer.at( 6, 26 ) = this->operator()( 0, 1, 2, 0, 2 );
      answer.at( 6, 27 ) = this->operator()( 0, 1, 1, 0, 2 );
      answer.at( 7, 1 ) = this->operator()( 2, 1, 0, 0, 0 );
      answer.at( 7, 2 ) = this->operator()( 2, 1, 1, 1, 0 );
      answer.at( 7, 3 ) = this->operator()( 2, 1, 2, 2, 0 );
      answer.at( 7, 4 ) = this->operator()( 2, 1, 1, 2, 0 );
      answer.at( 7, 5 ) = this->operator()( 2, 1, 0, 2, 0 );
      answer.at( 7, 6 ) = this->operator()( 2, 1, 0, 1, 0 );
      answer.at( 7, 7 ) = this->operator()( 2, 1, 2, 1, 0 );
      answer.at( 7, 8 ) = this->operator()( 2, 1, 2, 0, 0 );
      answer.at( 7, 9 ) = this->operator()( 2, 1, 1, 0, 0 );
      answer.at( 7, 10 ) = this->operator()( 2, 1, 0, 0, 1 );
      answer.at( 7, 11 ) = this->operator()( 2, 1, 1, 1, 1 );
      answer.at( 7, 12 ) = this->operator()( 2, 1, 2, 2, 1 );
      answer.at( 7, 13 ) = this->operator()( 2, 1, 1, 2, 1 );
      answer.at( 7, 14 ) = this->operator()( 2, 1, 0, 2, 1 );
      answer.at( 7, 15 ) = this->operator()( 2, 1, 0, 1, 1 );
      answer.at( 7, 16 ) = this->operator()( 2, 1, 2, 1, 1 );
      answer.at( 7, 17 ) = this->operator()( 2, 1, 2, 0, 1 );
      answer.at( 7, 18 ) = this->operator()( 2, 1, 1, 0, 1 );
      answer.at( 7, 19 ) = this->operator()( 2, 1, 0, 0, 2 );
      answer.at( 7, 20 ) = this->operator()( 2, 1, 1, 1, 2 );
      answer.at( 7, 21 ) = this->operator()( 2, 1, 2, 2, 2 );
      answer.at( 7, 22 ) = this->operator()( 2, 1, 1, 2, 2 );
      answer.at( 7, 23 ) = this->operator()( 2, 1, 0, 2, 2 );
      answer.at( 7, 24 ) = this->operator()( 2, 1, 0, 1, 2 );
      answer.at( 7, 25 ) = this->operator()( 2, 1, 2, 1, 2 );
      answer.at( 7, 26 ) = this->operator()( 2, 1, 2, 0, 2 );
      answer.at( 7, 27 ) = this->operator()( 2, 1, 1, 0, 2 );
      answer.at( 8, 1 ) = this->operator()( 2, 0, 0, 0, 0 );
      answer.at( 8, 2 ) = this->operator()( 2, 0, 1, 1, 0 );
      answer.at( 8, 3 ) = this->operator()( 2, 0, 2, 2, 0 );
      answer.at( 8, 4 ) = this->operator()( 2, 0, 1, 2, 0 );
      answer.at( 8, 5 ) = this->operator()( 2, 0, 0, 2, 0 );
      answer.at( 8, 6 ) = this->operator()( 2, 0, 0, 1, 0 );
      answer.at( 8, 7 ) = this->operator()( 2, 0, 2, 1, 0 );
      answer.at( 8, 8 ) = this->operator()( 2, 0, 2, 0, 0 );
      answer.at( 8, 9 ) = this->operator()( 2, 0, 1, 0, 0 );
      answer.at( 8, 10 ) = this->operator()( 2, 0, 0, 0, 1 );
      answer.at( 8, 11 ) = this->operator()( 2, 0, 1, 1, 1 );
      answer.at( 8, 12 ) = this->operator()( 2, 0, 2, 2, 1 );
      answer.at( 8, 13 ) = this->operator()( 2, 0, 1, 2, 1 );
      answer.at( 8, 14 ) = this->operator()( 2, 0, 0, 2, 1 );
      answer.at( 8, 15 ) = this->operator()( 2, 0, 0, 1, 1 );
      answer.at( 8, 16 ) = this->operator()( 2, 0, 2, 1, 1 );
      answer.at( 8, 17 ) = this->operator()( 2, 0, 2, 0, 1 );
      answer.at( 8, 18 ) = this->operator()( 2, 0, 1, 0, 1 );
      answer.at( 8, 19 ) = this->operator()( 2, 0, 0, 0, 2 );
      answer.at( 8, 20 ) = this->operator()( 2, 0, 1, 1, 2 );
      answer.at( 8, 21 ) = this->operator()( 2, 0, 2, 2, 2 );
      answer.at( 8, 22 ) = this->operator()( 2, 0, 1, 2, 2 );
      answer.at( 8, 23 ) = this->operator()( 2, 0, 0, 2, 2 );
      answer.at( 8, 24 ) = this->operator()( 2, 0, 0, 1, 2 );
      answer.at( 8, 25 ) = this->operator()( 2, 0, 2, 1, 2 );
      answer.at( 8, 26 ) = this->operator()( 2, 0, 2, 0, 2 );
      answer.at( 8, 27 ) = this->operator()( 2, 0, 1, 0, 2 );
      answer.at( 9, 1 ) = this->operator()( 1, 0, 0, 0, 0 );
      answer.at( 9, 2 ) = this->operator()( 1, 0, 1, 1, 0 );
      answer.at( 9, 3 ) = this->operator()( 1, 0, 2, 2, 0 );
      answer.at( 9, 4 ) = this->operator()( 1, 0, 1, 2, 0 );
      answer.at( 9, 5 ) = this->operator()( 1, 0, 0, 2, 0 );
      answer.at( 9, 6 ) = this->operator()( 1, 0, 0, 1, 0 );
      answer.at( 9, 7 ) = this->operator()( 1, 0, 2, 1, 0 );
      answer.at( 9, 8 ) = this->operator()( 1, 0, 2, 0, 0 );
      answer.at( 9, 9 ) = this->operator()( 1, 0, 1, 0, 0 );
      answer.at( 9, 10 ) = this->operator()( 1, 0, 0, 0, 1 );
      answer.at( 9, 11 ) = this->operator()( 1, 0, 1, 1, 1 );
      answer.at( 9, 12 ) = this->operator()( 1, 0, 2, 2, 1 );
      answer.at( 9, 13 ) = this->operator()( 1, 0, 1, 2, 1 );
      answer.at( 9, 14 ) = this->operator()( 1, 0, 0, 2, 1 );
      answer.at( 9, 15 ) = this->operator()( 1, 0, 0, 1, 1 );
      answer.at( 9, 16 ) = this->operator()( 1, 0, 2, 1, 1 );
      answer.at( 9, 17 ) = this->operator()( 1, 0, 2, 0, 1 );
      answer.at( 9, 18 ) = this->operator()( 1, 0, 1, 0, 1 );
      answer.at( 9, 19 ) = this->operator()( 1, 0, 0, 0, 2 );
      answer.at( 9, 20 ) = this->operator()( 1, 0, 1, 1, 2 );
      answer.at( 9, 21 ) = this->operator()( 1, 0, 2, 2, 2 );
      answer.at( 9, 22 ) = this->operator()( 1, 0, 1, 2, 2 );
      answer.at( 9, 23 ) = this->operator()( 1, 0, 0, 2, 2 );
      answer.at( 9, 24 ) = this->operator()( 1, 0, 0, 1, 2 );
      answer.at( 9, 25 ) = this->operator()( 1, 0, 2, 1, 2 );
      answer.at( 9, 26 ) = this->operator()( 1, 0, 2, 0, 2 );
      answer.at( 9, 27 ) = this->operator()( 1, 0, 1, 0, 2 );

      return answer;
    }


    /**
     * Transforms a second-order tensor into a floatmatrixf<27, 9>,  using the Voigt notation
     */

    const inline FloatMatrixF<27, 9> to_voigt_form_27x9()
    {
      FloatMatrixF<27, 9> answer;
      answer.at( 1, 1 ) = this->operator()( 0, 0, 0, 0, 0 );
      answer.at( 2, 1 ) = this->operator()( 1, 1, 0, 0, 0 );
      answer.at( 3, 1 ) = this->operator()( 2, 2, 0, 0, 0 );
      answer.at( 4, 1 ) = this->operator()( 1, 2, 0, 0, 0 );
      answer.at( 5, 1 ) = this->operator()( 0, 2, 0, 0, 0 );
      answer.at( 6, 1 ) = this->operator()( 0, 1, 0, 0, 0 );
      answer.at( 7, 1 ) = this->operator()( 2, 1, 0, 0, 0 );
      answer.at( 8, 1 ) = this->operator()( 2, 0, 0, 0, 0 );
      answer.at( 9, 1 ) = this->operator()( 1, 0, 0, 0, 0 );
      answer.at( 10, 1 ) = this->operator()( 0, 0, 1, 0, 0 );
      answer.at( 11, 1 ) = this->operator()( 1, 1, 1, 0, 0 );
      answer.at( 12, 1 ) = this->operator()( 2, 2, 1, 0, 0 );
      answer.at( 13, 1 ) = this->operator()( 1, 2, 1, 0, 0 );
      answer.at( 14, 1 ) = this->operator()( 0, 2, 1, 0, 0 );
      answer.at( 15, 1 ) = this->operator()( 0, 1, 1, 0, 0 );
      answer.at( 16, 1 ) = this->operator()( 2, 1, 1, 0, 0 );
      answer.at( 17, 1 ) = this->operator()( 2, 0, 1, 0, 0 );
      answer.at( 18, 1 ) = this->operator()( 1, 0, 1, 0, 0 );
      answer.at( 19, 1 ) = this->operator()( 0, 0, 2, 0, 0 );
      answer.at( 20, 1 ) = this->operator()( 1, 1, 2, 0, 0 );
      answer.at( 21, 1 ) = this->operator()( 2, 2, 2, 0, 0 );
      answer.at( 22, 1 ) = this->operator()( 1, 2, 2, 0, 0 );
      answer.at( 23, 1 ) = this->operator()( 0, 2, 2, 0, 0 );
      answer.at( 24, 1 ) = this->operator()( 0, 1, 2, 0, 0 );
      answer.at( 25, 1 ) = this->operator()( 2, 1, 2, 0, 0 );
      answer.at( 26, 1 ) = this->operator()( 2, 0, 2, 0, 0 );
      answer.at( 27, 1 ) = this->operator()( 1, 0, 2, 0, 0 );
      answer.at( 1, 2 ) = this->operator()( 0, 0, 0, 1, 1 );
      answer.at( 2, 2 ) = this->operator()( 1, 1, 0, 1, 1 );
      answer.at( 3, 2 ) = this->operator()( 2, 2, 0, 1, 1 );
      answer.at( 4, 2 ) = this->operator()( 1, 2, 0, 1, 1 );
      answer.at( 5, 2 ) = this->operator()( 0, 2, 0, 1, 1 );
      answer.at( 6, 2 ) = this->operator()( 0, 1, 0, 1, 1 );
      answer.at( 7, 2 ) = this->operator()( 2, 1, 0, 1, 1 );
      answer.at( 8, 2 ) = this->operator()( 2, 0, 0, 1, 1 );
      answer.at( 9, 2 ) = this->operator()( 1, 0, 0, 1, 1 );
      answer.at( 10, 2 ) = this->operator()( 0, 0, 1, 1, 1 );
      answer.at( 11, 2 ) = this->operator()( 1, 1, 1, 1, 1 );
      answer.at( 12, 2 ) = this->operator()( 2, 2, 1, 1, 1 );
      answer.at( 13, 2 ) = this->operator()( 1, 2, 1, 1, 1 );
      answer.at( 14, 2 ) = this->operator()( 0, 2, 1, 1, 1 );
      answer.at( 15, 2 ) = this->operator()( 0, 1, 1, 1, 1 );
      answer.at( 16, 2 ) = this->operator()( 2, 1, 1, 1, 1 );
      answer.at( 17, 2 ) = this->operator()( 2, 0, 1, 1, 1 );
      answer.at( 18, 2 ) = this->operator()( 1, 0, 1, 1, 1 );
      answer.at( 19, 2 ) = this->operator()( 0, 0, 2, 1, 1 );
      answer.at( 20, 2 ) = this->operator()( 1, 1, 2, 1, 1 );
      answer.at( 21, 2 ) = this->operator()( 2, 2, 2, 1, 1 );
      answer.at( 22, 2 ) = this->operator()( 1, 2, 2, 1, 1 );
      answer.at( 23, 2 ) = this->operator()( 0, 2, 2, 1, 1 );
      answer.at( 24, 2 ) = this->operator()( 0, 1, 2, 1, 1 );
      answer.at( 25, 2 ) = this->operator()( 2, 1, 2, 1, 1 );
      answer.at( 26, 2 ) = this->operator()( 2, 0, 2, 1, 1 );
      answer.at( 27, 2 ) = this->operator()( 1, 0, 2, 1, 1 );
      answer.at( 1, 3 ) = this->operator()( 0, 0, 0, 2, 2 );
      answer.at( 2, 3 ) = this->operator()( 1, 1, 0, 2, 2 );
      answer.at( 3, 3 ) = this->operator()( 2, 2, 0, 2, 2 );
      answer.at( 4, 3 ) = this->operator()( 1, 2, 0, 2, 2 );
      answer.at( 5, 3 ) = this->operator()( 0, 2, 0, 2, 2 );
      answer.at( 6, 3 ) = this->operator()( 0, 1, 0, 2, 2 );
      answer.at( 7, 3 ) = this->operator()( 2, 1, 0, 2, 2 );
      answer.at( 8, 3 ) = this->operator()( 2, 0, 0, 2, 2 );
      answer.at( 9, 3 ) = this->operator()( 1, 0, 0, 2, 2 );
      answer.at( 10, 3 ) = this->operator()( 0, 0, 1, 2, 2 );
      answer.at( 11, 3 ) = this->operator()( 1, 1, 1, 2, 2 );
      answer.at( 12, 3 ) = this->operator()( 2, 2, 1, 2, 2 );
      answer.at( 13, 3 ) = this->operator()( 1, 2, 1, 2, 2 );
      answer.at( 14, 3 ) = this->operator()( 0, 2, 1, 2, 2 );
      answer.at( 15, 3 ) = this->operator()( 0, 1, 1, 2, 2 );
      answer.at( 16, 3 ) = this->operator()( 2, 1, 1, 2, 2 );
      answer.at( 17, 3 ) = this->operator()( 2, 0, 1, 2, 2 );
      answer.at( 18, 3 ) = this->operator()( 1, 0, 1, 2, 2 );
      answer.at( 19, 3 ) = this->operator()( 0, 0, 2, 2, 2 );
      answer.at( 20, 3 ) = this->operator()( 1, 1, 2, 2, 2 );
      answer.at( 21, 3 ) = this->operator()( 2, 2, 2, 2, 2 );
      answer.at( 22, 3 ) = this->operator()( 1, 2, 2, 2, 2 );
      answer.at( 23, 3 ) = this->operator()( 0, 2, 2, 2, 2 );
      answer.at( 24, 3 ) = this->operator()( 0, 1, 2, 2, 2 );
      answer.at( 25, 3 ) = this->operator()( 2, 1, 2, 2, 2 );
      answer.at( 26, 3 ) = this->operator()( 2, 0, 2, 2, 2 );
      answer.at( 27, 3 ) = this->operator()( 1, 0, 2, 2, 2 );
      answer.at( 1, 4 ) = this->operator()( 0, 0, 0, 1, 2 );
      answer.at( 2, 4 ) = this->operator()( 1, 1, 0, 1, 2 );
      answer.at( 3, 4 ) = this->operator()( 2, 2, 0, 1, 2 );
      answer.at( 4, 4 ) = this->operator()( 1, 2, 0, 1, 2 );
      answer.at( 5, 4 ) = this->operator()( 0, 2, 0, 1, 2 );
      answer.at( 6, 4 ) = this->operator()( 0, 1, 0, 1, 2 );
      answer.at( 7, 4 ) = this->operator()( 2, 1, 0, 1, 2 );
      answer.at( 8, 4 ) = this->operator()( 2, 0, 0, 1, 2 );
      answer.at( 9, 4 ) = this->operator()( 1, 0, 0, 1, 2 );
      answer.at( 10, 4 ) = this->operator()( 0, 0, 1, 1, 2 );
      answer.at( 11, 4 ) = this->operator()( 1, 1, 1, 1, 2 );
      answer.at( 12, 4 ) = this->operator()( 2, 2, 1, 1, 2 );
      answer.at( 13, 4 ) = this->operator()( 1, 2, 1, 1, 2 );
      answer.at( 14, 4 ) = this->operator()( 0, 2, 1, 1, 2 );
      answer.at( 15, 4 ) = this->operator()( 0, 1, 1, 1, 2 );
      answer.at( 16, 4 ) = this->operator()( 2, 1, 1, 1, 2 );
      answer.at( 17, 4 ) = this->operator()( 2, 0, 1, 1, 2 );
      answer.at( 18, 4 ) = this->operator()( 1, 0, 1, 1, 2 );
      answer.at( 19, 4 ) = this->operator()( 0, 0, 2, 1, 2 );
      answer.at( 20, 4 ) = this->operator()( 1, 1, 2, 1, 2 );
      answer.at( 21, 4 ) = this->operator()( 2, 2, 2, 1, 2 );
      answer.at( 22, 4 ) = this->operator()( 1, 2, 2, 1, 2 );
      answer.at( 23, 4 ) = this->operator()( 0, 2, 2, 1, 2 );
      answer.at( 24, 4 ) = this->operator()( 0, 1, 2, 1, 2 );
      answer.at( 25, 4 ) = this->operator()( 2, 1, 2, 1, 2 );
      answer.at( 26, 4 ) = this->operator()( 2, 0, 2, 1, 2 );
      answer.at( 27, 4 ) = this->operator()( 1, 0, 2, 1, 2 );
      answer.at( 1, 5 ) = this->operator()( 0, 0, 0, 0, 2 );
      answer.at( 2, 5 ) = this->operator()( 1, 1, 0, 0, 2 );
      answer.at( 3, 5 ) = this->operator()( 2, 2, 0, 0, 2 );
      answer.at( 4, 5 ) = this->operator()( 1, 2, 0, 0, 2 );
      answer.at( 5, 5 ) = this->operator()( 0, 2, 0, 0, 2 );
      answer.at( 6, 5 ) = this->operator()( 0, 1, 0, 0, 2 );
      answer.at( 7, 5 ) = this->operator()( 2, 1, 0, 0, 2 );
      answer.at( 8, 5 ) = this->operator()( 2, 0, 0, 0, 2 );
      answer.at( 9, 5 ) = this->operator()( 1, 0, 0, 0, 2 );
      answer.at( 10, 5 ) = this->operator()( 0, 0, 1, 0, 2 );
      answer.at( 11, 5 ) = this->operator()( 1, 1, 1, 0, 2 );
      answer.at( 12, 5 ) = this->operator()( 2, 2, 1, 0, 2 );
      answer.at( 13, 5 ) = this->operator()( 1, 2, 1, 0, 2 );
      answer.at( 14, 5 ) = this->operator()( 0, 2, 1, 0, 2 );
      answer.at( 15, 5 ) = this->operator()( 0, 1, 1, 0, 2 );
      answer.at( 16, 5 ) = this->operator()( 2, 1, 1, 0, 2 );
      answer.at( 17, 5 ) = this->operator()( 2, 0, 1, 0, 2 );
      answer.at( 18, 5 ) = this->operator()( 1, 0, 1, 0, 2 );
      answer.at( 19, 5 ) = this->operator()( 0, 0, 2, 0, 2 );
      answer.at( 20, 5 ) = this->operator()( 1, 1, 2, 0, 2 );
      answer.at( 21, 5 ) = this->operator()( 2, 2, 2, 0, 2 );
      answer.at( 22, 5 ) = this->operator()( 1, 2, 2, 0, 2 );
      answer.at( 23, 5 ) = this->operator()( 0, 2, 2, 0, 2 );
      answer.at( 24, 5 ) = this->operator()( 0, 1, 2, 0, 2 );
      answer.at( 25, 5 ) = this->operator()( 2, 1, 2, 0, 2 );
      answer.at( 26, 5 ) = this->operator()( 2, 0, 2, 0, 2 );
      answer.at( 27, 5 ) = this->operator()( 1, 0, 2, 0, 2 );
      answer.at( 1, 6 ) = this->operator()( 0, 0, 0, 0, 1 );
      answer.at( 2, 6 ) = this->operator()( 1, 1, 0, 0, 1 );
      answer.at( 3, 6 ) = this->operator()( 2, 2, 0, 0, 1 );
      answer.at( 4, 6 ) = this->operator()( 1, 2, 0, 0, 1 );
      answer.at( 5, 6 ) = this->operator()( 0, 2, 0, 0, 1 );
      answer.at( 6, 6 ) = this->operator()( 0, 1, 0, 0, 1 );
      answer.at( 7, 6 ) = this->operator()( 2, 1, 0, 0, 1 );
      answer.at( 8, 6 ) = this->operator()( 2, 0, 0, 0, 1 );
      answer.at( 9, 6 ) = this->operator()( 1, 0, 0, 0, 1 );
      answer.at( 10, 6 ) = this->operator()( 0, 0, 1, 0, 1 );
      answer.at( 11, 6 ) = this->operator()( 1, 1, 1, 0, 1 );
      answer.at( 12, 6 ) = this->operator()( 2, 2, 1, 0, 1 );
      answer.at( 13, 6 ) = this->operator()( 1, 2, 1, 0, 1 );
      answer.at( 14, 6 ) = this->operator()( 0, 2, 1, 0, 1 );
      answer.at( 15, 6 ) = this->operator()( 0, 1, 1, 0, 1 );
      answer.at( 16, 6 ) = this->operator()( 2, 1, 1, 0, 1 );
      answer.at( 17, 6 ) = this->operator()( 2, 0, 1, 0, 1 );
      answer.at( 18, 6 ) = this->operator()( 1, 0, 1, 0, 1 );
      answer.at( 19, 6 ) = this->operator()( 0, 0, 2, 0, 1 );
      answer.at( 20, 6 ) = this->operator()( 1, 1, 2, 0, 1 );
      answer.at( 21, 6 ) = this->operator()( 2, 2, 2, 0, 1 );
      answer.at( 22, 6 ) = this->operator()( 1, 2, 2, 0, 1 );
      answer.at( 23, 6 ) = this->operator()( 0, 2, 2, 0, 1 );
      answer.at( 24, 6 ) = this->operator()( 0, 1, 2, 0, 1 );
      answer.at( 25, 6 ) = this->operator()( 2, 1, 2, 0, 1 );
      answer.at( 26, 6 ) = this->operator()( 2, 0, 2, 0, 1 );
      answer.at( 27, 6 ) = this->operator()( 1, 0, 2, 0, 1 );
      answer.at( 1, 7 ) = this->operator()( 0, 0, 0, 2, 1 );
      answer.at( 2, 7 ) = this->operator()( 1, 1, 0, 2, 1 );
      answer.at( 3, 7 ) = this->operator()( 2, 2, 0, 2, 1 );
      answer.at( 4, 7 ) = this->operator()( 1, 2, 0, 2, 1 );
      answer.at( 5, 7 ) = this->operator()( 0, 2, 0, 2, 1 );
      answer.at( 6, 7 ) = this->operator()( 0, 1, 0, 2, 1 );
      answer.at( 7, 7 ) = this->operator()( 2, 1, 0, 2, 1 );
      answer.at( 8, 7 ) = this->operator()( 2, 0, 0, 2, 1 );
      answer.at( 9, 7 ) = this->operator()( 1, 0, 0, 2, 1 );
      answer.at( 10, 7 ) = this->operator()( 0, 0, 1, 2, 1 );
      answer.at( 11, 7 ) = this->operator()( 1, 1, 1, 2, 1 );
      answer.at( 12, 7 ) = this->operator()( 2, 2, 1, 2, 1 );
      answer.at( 13, 7 ) = this->operator()( 1, 2, 1, 2, 1 );
      answer.at( 14, 7 ) = this->operator()( 0, 2, 1, 2, 1 );
      answer.at( 15, 7 ) = this->operator()( 0, 1, 1, 2, 1 );
      answer.at( 16, 7 ) = this->operator()( 2, 1, 1, 2, 1 );
      answer.at( 17, 7 ) = this->operator()( 2, 0, 1, 2, 1 );
      answer.at( 18, 7 ) = this->operator()( 1, 0, 1, 2, 1 );
      answer.at( 19, 7 ) = this->operator()( 0, 0, 2, 2, 1 );
      answer.at( 20, 7 ) = this->operator()( 1, 1, 2, 2, 1 );
      answer.at( 21, 7 ) = this->operator()( 2, 2, 2, 2, 1 );
      answer.at( 22, 7 ) = this->operator()( 1, 2, 2, 2, 1 );
      answer.at( 23, 7 ) = this->operator()( 0, 2, 2, 2, 1 );
      answer.at( 24, 7 ) = this->operator()( 0, 1, 2, 2, 1 );
      answer.at( 25, 7 ) = this->operator()( 2, 1, 2, 2, 1 );
      answer.at( 26, 7 ) = this->operator()( 2, 0, 2, 2, 1 );
      answer.at( 27, 7 ) = this->operator()( 1, 0, 2, 2, 1 );
      answer.at( 1, 8 ) = this->operator()( 0, 0, 0, 2, 0 );
      answer.at( 2, 8 ) = this->operator()( 1, 1, 0, 2, 0 );
      answer.at( 3, 8 ) = this->operator()( 2, 2, 0, 2, 0 );
      answer.at( 4, 8 ) = this->operator()( 1, 2, 0, 2, 0 );
      answer.at( 5, 8 ) = this->operator()( 0, 2, 0, 2, 0 );
      answer.at( 6, 8 ) = this->operator()( 0, 1, 0, 2, 0 );
      answer.at( 7, 8 ) = this->operator()( 2, 1, 0, 2, 0 );
      answer.at( 8, 8 ) = this->operator()( 2, 0, 0, 2, 0 );
      answer.at( 9, 8 ) = this->operator()( 1, 0, 0, 2, 0 );
      answer.at( 10, 8 ) = this->operator()( 0, 0, 1, 2, 0 );
      answer.at( 11, 8 ) = this->operator()( 1, 1, 1, 2, 0 );
      answer.at( 12, 8 ) = this->operator()( 2, 2, 1, 2, 0 );
      answer.at( 13, 8 ) = this->operator()( 1, 2, 1, 2, 0 );
      answer.at( 14, 8 ) = this->operator()( 0, 2, 1, 2, 0 );
      answer.at( 15, 8 ) = this->operator()( 0, 1, 1, 2, 0 );
      answer.at( 16, 8 ) = this->operator()( 2, 1, 1, 2, 0 );
      answer.at( 17, 8 ) = this->operator()( 2, 0, 1, 2, 0 );
      answer.at( 18, 8 ) = this->operator()( 1, 0, 1, 2, 0 );
      answer.at( 19, 8 ) = this->operator()( 0, 0, 2, 2, 0 );
      answer.at( 20, 8 ) = this->operator()( 1, 1, 2, 2, 0 );
      answer.at( 21, 8 ) = this->operator()( 2, 2, 2, 2, 0 );
      answer.at( 22, 8 ) = this->operator()( 1, 2, 2, 2, 0 );
      answer.at( 23, 8 ) = this->operator()( 0, 2, 2, 2, 0 );
      answer.at( 24, 8 ) = this->operator()( 0, 1, 2, 2, 0 );
      answer.at( 25, 8 ) = this->operator()( 2, 1, 2, 2, 0 );
      answer.at( 26, 8 ) = this->operator()( 2, 0, 2, 2, 0 );
      answer.at( 27, 8 ) = this->operator()( 1, 0, 2, 2, 0 );
      answer.at( 1, 9 ) = this->operator()( 0, 0, 0, 1, 0 );
      answer.at( 2, 9 ) = this->operator()( 1, 1, 0, 1, 0 );
      answer.at( 3, 9 ) = this->operator()( 2, 2, 0, 1, 0 );
      answer.at( 4, 9 ) = this->operator()( 1, 2, 0, 1, 0 );
      answer.at( 5, 9 ) = this->operator()( 0, 2, 0, 1, 0 );
      answer.at( 6, 9 ) = this->operator()( 0, 1, 0, 1, 0 );
      answer.at( 7, 9 ) = this->operator()( 2, 1, 0, 1, 0 );
      answer.at( 8, 9 ) = this->operator()( 2, 0, 0, 1, 0 );
      answer.at( 9, 9 ) = this->operator()( 1, 0, 0, 1, 0 );
      answer.at( 10, 9 ) = this->operator()( 0, 0, 1, 1, 0 );
      answer.at( 11, 9 ) = this->operator()( 1, 1, 1, 1, 0 );
      answer.at( 12, 9 ) = this->operator()( 2, 2, 1, 1, 0 );
      answer.at( 13, 9 ) = this->operator()( 1, 2, 1, 1, 0 );
      answer.at( 14, 9 ) = this->operator()( 0, 2, 1, 1, 0 );
      answer.at( 15, 9 ) = this->operator()( 0, 1, 1, 1, 0 );
      answer.at( 16, 9 ) = this->operator()( 2, 1, 1, 1, 0 );
      answer.at( 17, 9 ) = this->operator()( 2, 0, 1, 1, 0 );
      answer.at( 18, 9 ) = this->operator()( 1, 0, 1, 1, 0 );
      answer.at( 19, 9 ) = this->operator()( 0, 0, 2, 1, 0 );
      answer.at( 20, 9 ) = this->operator()( 1, 1, 2, 1, 0 );
      answer.at( 21, 9 ) = this->operator()( 2, 2, 2, 1, 0 );
      answer.at( 22, 9 ) = this->operator()( 1, 2, 2, 1, 0 );
      answer.at( 23, 9 ) = this->operator()( 0, 2, 2, 1, 0 );
      answer.at( 24, 9 ) = this->operator()( 0, 1, 2, 1, 0 );
      answer.at( 25, 9 ) = this->operator()( 2, 1, 2, 1, 0 );
      answer.at( 26, 9 ) = this->operator()( 2, 0, 2, 1, 0 );
      answer.at( 27, 9 ) = this->operator()( 1, 0, 2, 1, 0 );


      return answer;
    }  

  
};
} // namespace oofem
